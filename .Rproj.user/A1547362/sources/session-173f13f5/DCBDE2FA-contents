---
title: "Consultoria Victor"
author: "James D Santos"
date: "2022-12-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(RColorBrewer)
library(flextable)
library(dplyr)
library(magrittr)
library(tidyr)
library(hexbin)
library(FSA)
library(dunn.test)
library(DescTools)
require(kableExtra)
```

```{r, echo = F}
setwd('C:/Users/jam_d/Documents/Consultorias/Victor')
data   <- read.csv('banco.csv', sep = ',', header = T, encoding = 'UTF-8')
perfil <- read.csv('perfil.csv', sep = ',', header = T)
data$IDADE <- NA
data$`ESTADO CIVIL` <- NA
data$ESCOLARIDADE <- NA
data$RENDA <- NA
data$REGIAO <- NA
data$AMBIENTE <- NA
data$POSTO <- NA

ID_data <- unique( data$ID)
i <- ID_data[1]
for(i in ID_data){
  data$IDADE[data$ID == i] <- perfil$IDADE[perfil$ID == i]
  data$`ESTADO CIVIL`[data$ID == i] <- perfil$ESTADO.CIVIL[perfil$ID == i]
  data$ESCOLARIDADE[data$ID == i] <- perfil$ESCOLARIDADE [perfil$ID == i]
  data$RENDA[data$ID == i] <- perfil$RENDA[perfil$ID == i]
  data$REGIAO[data$ID == i] <- perfil$REGIAO [perfil$ID == i]
  data$AMBIENTE[data$ID == i] <- perfil$AMBIENTE[perfil$ID == i]
  data$POSTO[data$ID == i] <- perfil$POSTO[perfil$ID == i]
}

data$REGIAO <- as.factor(data$REGIAO)
  levels(data$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')

data$AMBIENTE <- as.factor(data$AMBIENTE)
  levels(data$AMBIENTE) <- c('Caatinga',
 'Selva',
 'Pantanal',
'Montanha',
 'Nenhuma das alternativas')

  
data$IDADE <- as.factor(data$IDADE)
levels(data$IDADE) <- c('18-25','26-35','36-45','>45')

data$`ESTADO CIVIL` <- as.factor(data$`ESTADO CIVIL`)
levels(data$`ESTADO CIVIL`) <- c('Solteiro','União estável','Casado','Divorciado','Viúvo')

data$ESCOLARIDADE <- as.factor(data$ESCOLARIDADE)
levels(data$ESCOLARIDADE) <- c(
  'Sem escolaridade',
'Ensino Fundamental Incompleto',
'Ensino Fundamental Completo',
'Ensino Médio Incompleto',
'Ensino Médio Completo',
'Ensino Técnico',
'Ensino Superior Incompleto',
'Ensino Superior Completo',
'Pós-graduação',
'Prefiro não mencionar'
)

data$RENDA <- as.factor(data$RENDA)
levels(data$RENDA) <- c(
  'Até 1 salário mínimo',
'Entre 2 e 5 salários mínimos',
'Entre 6 e 10 salários mínimos',
'Acima de 10 salários mínimos',
'Prefiro não informar')

data$POSTO <- as.factor(data$POSTO)
levels(data$POSTO) <- c(
  'Aluno',
 'Cb/Sd',
 'St/Sgt',
'Cap/Ten/ Asp',
'Of Superior'
)



```

## Correlação entre aceitação e consumo

A correlação entre a aceitação e o consumo é de 0,7, um valor considerado alto.

```{r}
# correlação entre aceitação e consumo
cor(data$aceitacao,data$consumo)
    
```

## Avaliação do perfil de aceitação dos cardápios (café da manhã) de rações operacionais em diferentes ambientes operacionais/regionais

-   As tabelas a seguir apresentam a média amostral, o desvio padrão e a estatística $Z$ para o teste das hipóteses: $H_0:\hbox {aceitação média }\leq 6$ contra $H_1:\hbox{aceitação média}>6$.

-   O teste $Z$ foi utilizado porque considerou-se que o tamanho da amostra é grande o suficiente para grarantir a distribuição normal da média amostral. Note que a hipótese de interesse (aceitação maior que \>6) está em $H_1$. Fazemos isso porque testes de hipóteses frequentistas são construídos para rejeitar a hipótese $H_0$ (e, por consequência, aceitar $H_1$).

-   Em cada tabela, há uma coluna denominada p-valor. Valores menores que 0,05 dão evidências de que o cardápio é aceito. Para destacar esses valores, colocamos um `*`.

A Tabela 1 apresenta a aceitação média dos cardápios de café da manhã. No geral, os cardápios `Bebida Láctea - chocolate`, `Bebida láctea - salada de frutas`, `Café solúvel com leite e açúcar` e `Café solúvel` não são bem aceitos.

```{r echo = F}
D <- aggregate( data$aceitacao, list(data$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( data$aceitacao, list(data$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( data$aceitacao, list(data$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

require(magrittr)

ktable <- kable(Dtable, caption = 'Tabela 1. Aceitação por cardápio de café da manhã') %>%
  kable_classic(bootstrap_options = 'basic')

ktable
```

A Figura 1 representa a mesma informação da Tabela 1, mas em forma de gráficos de barras.

```{r figure1-plot, dev = 'png', fig.show='hide',echo = F}
D <- aggregate( data$aceitacao, list(data$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( data$aceitacao, list(data$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( data$aceitacao, list(data$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

Dtable$Cardápio[3] <- 'Barra de proteína'
Dtable$Cardápio[5] <- 'Bebida láctea - sld. de frutas'
Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,14),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Café da Manhã')
for(i in 1:13){
  symbols(1:13,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:13-1/4,rep(1/3,13),Dtable$Cardápio,srt = 90, cex = .8, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,14),labels=c('',''))
```

![Figura 1. Aceitação média do cardápio de café da manhã. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure1-plot','png')`)

A Tabela 2 apresenta a aceitação por região. Destacam-se as seguintes diferenças regionais:

-   *Norte* Apenas a `Bebida láctea - salada de frutas` e o `Café solúvel` não são bem aceitos.

-   *Nordeste*: não são bem aceitos: as bebidas lácteas em geral, o `Biscoito cream cracker`, o `Café com leite e açúcar`, o `Refresco de fruta em pó` e o `Repositor hidroeletrolítico`.

-   *Centro-Oeste e Sudeste:* não são bem aceitos os mesmos cardápios encontrados na Tabela 1.

-   *Sul*: além das `bebidas lácteas` e dos `cafés`, o `Refresco de fruta em pó`também não é bem aceito.

```{r echo = F}
D <- aggregate( data$aceitacao, list(data$cardapio,data$REGIAO), function(x) round(mean(x),2))
Dm <- D[,3]
Ds <- aggregate( data$aceitacao, list(data$cardapio,data$REGIAO), function(x) round(sd(x),2))[,3]
Dn <- aggregate( data$aceitacao, list(data$cardapio,data$REGIAO), function(x) length(x))[,3]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1:2], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio - café da manhã','Região','Média','Desvio padrão','Estatística Z','p-valor')

require(magrittr)

ktable <- kable(Dtable[,-2],caption = 'Tabela 2. Aceitação por cardápio de café da manhã e região') %>%
  kable_classic(bootstrap_options = 'basic') %>%
  group_rows('Norte', 1,13) %>%
  group_rows('Nordeste',14,26) %>%
  group_rows('Centro-Oeste',27,39) %>%
  group_rows('Sudeste',40,52) %>%
  group_rows('Sul',53,65) 
  

ktable
```

As Figuras 2 a 6 mostram os dados da Tabela 2 para cada região.

```{r figure1-Norte-plot, dev = 'png', fig.show='hide',echo = F}
dataNorte <- data[data$REGIAO == 'Norte', ]
D <- aggregate( dataNorte$aceitacao, list(dataNorte$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataNorte$aceitacao, list(dataNorte$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataNorte$aceitacao, list(dataNorte$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

Dtable$Cardápio[3] <- 'Barra de proteína'
Dtable$Cardápio[5] <- 'Bebida láctea - sl. de frutas'
Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,14),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Café da Manhã - Região Norte')
for(i in 1:13){
  symbols(1:13,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:13-1/4,rep(1/3,13),Dtable$Cardápio,srt = 90, cex = .8, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,14),labels=c('',''))
```

```{r figure1-Nordeste-plot, dev = 'png', fig.show='hide',echo = F}
dataNordeste <- data[data$REGIAO == 'Nordeste', ]
D <- aggregate( dataNordeste$aceitacao, list(dataNordeste$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataNordeste$aceitacao, list(dataNordeste$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataNordeste$aceitacao, list(dataNordeste$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

Dtable$Cardápio[3] <- 'Barra de proteína'
Dtable$Cardápio[5] <- 'Bebida láctea - sl. de frutas'
Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,14),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Café da Manhã - Região Nordeste')
for(i in 1:13){
  symbols(1:13,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:13-1/4,rep(1/3,13),Dtable$Cardápio,srt = 90, cex = .8, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,14),labels=c('',''))
```

```{r figure1-CO-plot, dev = 'png', fig.show='hide',echo = F}
dataCO <- data[data$REGIAO == 'Centro-Oeste', ]
D <- aggregate( dataCO$aceitacao, list(dataCO$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataCO$aceitacao, list(dataCO$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataCO$aceitacao, list(dataCO$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

Dtable$Cardápio[3] <- 'Barra de proteína'
Dtable$Cardápio[5] <- 'Bebida láctea - sl. de frutas'
Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,14),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Café da Manhã - Região Centro-Oeste')
for(i in 1:13){
  symbols(1:13,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:13-1/4,rep(1/3,13),Dtable$Cardápio,srt = 90, cex = .8, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,14),labels=c('',''))
```

```{r figure1-Sudeste-plot, dev = 'png', fig.show='hide',echo = F}
dataSudeste <- data[data$REGIAO == 'Sudeste', ]
D <- aggregate( dataSudeste$aceitacao, list(dataSudeste$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataSudeste$aceitacao, list(dataSudeste$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataSudeste$aceitacao, list(dataSudeste$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

Dtable$Cardápio[3] <- 'Barra de proteína'
Dtable$Cardápio[5] <- 'Bebida láctea - sl. de frutas'
Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,14),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Café da Manhã - Região Sudeste')
for(i in 1:13){
  symbols(1:13,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:13-1/4,rep(1/3,13),Dtable$Cardápio,srt = 90, cex = .8, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,14),labels=c('',''))
```

```{r figure1-Sul-plot, dev = 'png', fig.show='hide',echo = F}
dataSul <- data[data$REGIAO == 'Sul', ]
D <- aggregate( dataSul$aceitacao, list(dataSul$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataSul$aceitacao, list(dataSul$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataSul$aceitacao, list(dataSul$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

Dtable$Cardápio[3] <- 'Barra de proteína'
Dtable$Cardápio[5] <- 'Bebida láctea - sl. de frutas'
Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,14),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Café da Manhã - Região Sul')
for(i in 1:13){
  symbols(1:13,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:13-1/4,rep(1/3,13),Dtable$Cardápio,srt = 90, cex = .8, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,14),labels=c('',''))
```

![Figura 2. Aceitação média do cardápio de café da manhã considerando a regão Norte. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure1-Norte-plot','png')`)

![Figura 3. Aceitação média do cardápio de café da manhã considerando a regão Nordeste. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure1-Nordeste-plot','png')`)

![Figura 4. Aceitação média do cardápio de café da manhã considerando a regão Centro-Oeste. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure1-CO-plot','png')`)

![Figura 5. Aceitação média do cardápio de café da manhã considerando a regão Sudeste. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure1-Sudeste-plot','png')`)

![Figura 6. Aceitação média do cardápio de café da manhã considerando a regão Sul. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure1-Sul-plot','png')`)

A Tabela 3 mostra a aceitação média dos cardápios de café da manhã nos ambientes. Destacamos:

-   *Caatinga*: não são bem aceitos os `cafés`, a `geléia de goiaba` e o `refresco de fruta em pó`.

-   *Selva*: não são bem aceitos a `Bebida láctea - salada de frutas` e o `café solúvel`.

-   *Pantanal e Montanha*: não são bem aceitos as `bebidas lácteas`, os `cafés` e o `refresco de fruta em pó`.

-   *Outros*: não são bem aceitos as `bebidas lácteas` e os `cafés`.

```{r echo = F}
D <- aggregate( data$aceitacao, list(data$cardapio,data$AMBIENTE), function(x) round(mean(x),2))
Dm <- D[,3]
Ds <- aggregate( data$aceitacao, list(data$cardapio,data$AMBIENTE), function(x) round(sd(x),2))[,3]
Dn <- aggregate( data$aceitacao, list(data$cardapio,data$AMBIENTE), function(x) length(x))[,3]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1:2], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio - café da manhã','Ambiente','Média','Desvio padrão','Estatística Z','p-valor')

require(magrittr)

ktable <- kable(Dtable[,-2],caption = 'Tabela 3. Aceitação por cardápio de café da manhã e ambiente') %>%
  kable_classic(bootstrap_options = 'basic') %>%
  group_rows('Caating', 1,13) %>%
  group_rows('Selva',14,26) %>%
  group_rows('Pantanal',27,39) %>%
  group_rows('Montanha',40,52) %>%
  group_rows('Outro',53,65) 
  

ktable
```


As Figuras de 7 a 11 apresentam as informações da Tabela 3.

```{r figure1-Caatinga-plot, dev = 'png', fig.show='hide',echo = F}
dataCaatinga <- data[data$AMBIENTE == 'Caatinga', ]
D <- aggregate( dataCaatinga$aceitacao, list(dataCaatinga$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataCaatinga$aceitacao, list(dataCaatinga$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataCaatinga$aceitacao, list(dataCaatinga$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

Dtable$Cardápio[3] <- 'Barra de proteína'
Dtable$Cardápio[5] <- 'Bebida láctea - sl. de frutas'
Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,14),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Café da Manhã - Caatinga')
for(i in 1:13){
  symbols(1:13,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:13-1/4,rep(1/3,13),Dtable$Cardápio,srt = 90, cex = .8, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,14),labels=c('',''))
```

```{r figure1-Selva-plot, dev = 'png', fig.show='hide',echo = F}
dataSelva <- data[data$AMBIENTE == 'Selva', ]
D <- aggregate( dataSelva$aceitacao, list(dataSelva$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataSelva$aceitacao, list(dataSelva$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataSelva$aceitacao, list(dataSelva$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

Dtable$Cardápio[3] <- 'Barra de proteína'
Dtable$Cardápio[5] <- 'Bebida láctea - sl. de frutas'
Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,14),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Café da Manhã - Selva')
for(i in 1:13){
  symbols(1:13,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:13-1/4,rep(1/3,13),Dtable$Cardápio,srt = 90, cex = .8, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,14),labels=c('',''))
```

```{r figure1-Pantanal-plot, dev = 'png', fig.show='hide',echo = F}
dataPantanal <- data[data$AMBIENTE == 'Pantanal', ]
D <- aggregate( dataPantanal$aceitacao, list(dataPantanal$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataPantanal$aceitacao, list(dataPantanal$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataPantanal$aceitacao, list(dataPantanal$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

Dtable$Cardápio[3] <- 'Barra de proteína'
Dtable$Cardápio[5] <- 'Bebida láctea - sl. de frutas'
Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,14),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Café da Manhã - Pantanal')
for(i in 1:13){
  symbols(1:13,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:13-1/4,rep(1/3,13),Dtable$Cardápio,srt = 90, cex = .8, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,14),labels=c('',''))
```

```{r figure1-Montanha-plot, dev = 'png', fig.show='hide',echo = F}
dataMontanha <- data[data$AMBIENTE == 'Montanha', ]
D <- aggregate( dataMontanha$aceitacao, list(dataMontanha$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataMontanha$aceitacao, list(dataMontanha$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataMontanha$aceitacao, list(dataMontanha$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

Dtable$Cardápio[3] <- 'Barra de proteína'
Dtable$Cardápio[5] <- 'Bebida láctea - sl. de frutas'
Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,14),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Café da Manhã - Montanha')
for(i in 1:13){
  symbols(1:13,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:13-1/4,rep(1/3,13),Dtable$Cardápio,srt = 90, cex = .8, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,14),labels=c('',''))
```

```{r figure1-Outro-plot, dev = 'png', fig.show='hide',echo = F}
dataOutro <- data[data$AMBIENTE == 'Nenhuma das alternativas', ]
D <- aggregate( dataOutro$aceitacao, list(dataOutro$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataOutro$aceitacao, list(dataOutro$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataOutro$aceitacao, list(dataOutro$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

Dtable$Cardápio[3] <- 'Barra de proteína'
Dtable$Cardápio[5] <- 'Bebida láctea - sl. de frutas'
Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,14),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Café da Manhã - outros ambientes operacionais')
for(i in 1:13){
  symbols(1:13,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:13-1/4,rep(1/3,13),Dtable$Cardápio,srt = 90, cex = .8, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,14),labels=c('',''))
```


![Figura 7. Aceitação média do cardápio de café da manhã considerando o ambiente operacional Caatinga. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure1-Caatinga-plot','png')`)

![Figura 8. Aceitação média do cardápio de café da manhã considerando o ambiente operacional Selva. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure1-Selva-plot','png')`)


![Figura 9. Aceitação média do cardápio de café da manhã considerando o ambiente operacional Pantanal. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure1-Pantanal-plot','png')`)


![Figura 10. Aceitação média do cardápio de café da manhã considerando o ambiente operacional Montanha. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure1-Montanha-plot','png')`)


![Figura 11. Aceitação média do cardápio de café da manhã considerando os demais ambientes operacionais . As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure1-Outro-plot','png')`)




A Tabela 4 aparesenta a média da aceitação para cada cardápio e para cada variável de perfil do participante. O símbolo (\*) representa que a média é maior que 6 (utilizou-se o teste $t$, porque algumas categorias possuem tamanho de amostra pequeno). Te recomendo usar essa tabela com cautela: o número excessivo de testes de hipóteses aumentam as chances de acharmos relações que não existem. Vou discutir alguns pontos:

-   `Bebida láctea - salada de frutas` e `café solúvel` tem aceitação baixa em quase todos os perfis

-   *Idade*: indivíduos entre 18 e 35 anos tendem a gosta de `refresco`, enquanto que os maiores de 36 tem preferência pela `bebida láctea - chocolate`

-   *Grau de instrução*: as aceitações mais baixas são observadas nos indivíduos com pós-graduação

-   A *renda familiar* não parece ter muita influência

-   O *posto* não parece ter muita influência

```{r echo = F}
levels(data$cardapio) <- c(
  'Balas de goma (jujuba)',
  'Bananada',
  'Barra de proteína - sabor cookies e cream',
  'Bebida láctea - chocolate',
  'Bebida láctea - salada de frutas',
  'Biscoito cream cracker',
  'Café com leite e açúcar',
  'Café solúvel',
  'Geleia de goiaba',
  'Geleia de morango',
  'Rapadura',
  'Refresco de fruta em pó - sabores variados',
  'Repositor hidroeletrolítico'
)
card <- levels(data$cardapio)
c_aux <- NULL
for(i in 1:length(card)){
  r_aux <- rep(0,29)
  aux <- data[data$cardapio == card[i],]
  a1 <- aggregate(aux$aceitacao, list(aux$IDADE), function(x) round(mean(x),2) )
  a2 <- aggregate(aux$aceitacao, list(aux$IDADE), sd)[,2]
  a3 <- aggregate(aux$aceitacao, list(aux$IDADE), length)[,2]
  a4 <- 1-pt( sqrt(a3)*(a1[,2]-6)/a2,sqrt(a3))
  a5 <- ifelse( a4 < .05,'(*)','')
  a6 <- NULL
  for(j in 1:length(a5)) a6[j] <- paste(a1[j,2],a5[j], sep='')
  for(j in levels(data$IDADE)){
    if( sum( a1[,1] == j)  >0){
      id1 <- which(levels(data$IDADE) == j)
      id2 <- which(a1[,1] == j)
      
      r_aux[id1] <- a6[id2]
  }}

  a1 <- aggregate(aux$aceitacao, list(aux$`ESTADO CIVIL`), function(x) round(mean(x),2) )
  a2 <- aggregate(aux$aceitacao, list(aux$`ESTADO CIVIL`), sd)[,2]
  a3 <- aggregate(aux$aceitacao, list(aux$`ESTADO CIVIL`), length)[,2]
  a4 <- 1-pt( sqrt(a3)*(a1[,2]-6)/a2,sqrt(a3))
  a5 <- ifelse( a4 < .05,'(*)','')
  a6 <- NULL
  for(j in 1:length(a5)) a6[j] <- paste(a1[j,2],a5[j], sep='')
  for(j in levels(data$`ESTADO CIVIL`)){
    if( sum( a1[,1] == j)  >0){
      id1 <- which(levels(data$`ESTADO CIVIL`) == j)
      id2 <- which(a1[,1] == j)
      
      r_aux[4+id1] <- a6[id2]
    }}
    
  a1 <- aggregate(aux$aceitacao, list(aux$ESCOLARIDADE), function(x) round(mean(x),2) )
  a2 <- aggregate(aux$aceitacao, list(aux$ESCOLARIDADE), sd)[,2]
  a3 <- aggregate(aux$aceitacao, list(aux$ESCOLARIDADE), length)[,2]
  a4 <- 1-pt( sqrt(a3)*(a1[,2]-6)/a2,sqrt(a3))
  a5 <- ifelse( a4 < .05,'(*)','')
  a6 <- NULL
  for(j in 1:length(a5)) a6[j] <- paste(a1[j,2],a5[j], sep='')
  for(j in levels(data$ESCOLARIDADE)){
    if( sum( a1[,1] == j)  >0){
      id1 <- which(levels(data$ESCOLARIDADE) == j)
      id2 <- which(a1[,1] == j)
      r_aux[9+id1] <- a6[id2]
    }}
    
   a1 <- aggregate(aux$aceitacao, list(aux$RENDA), function(x) round(mean(x),2) )
  a2 <- aggregate(aux$aceitacao, list(aux$RENDA), sd)[,2]
  a3 <- aggregate(aux$aceitacao, list(aux$RENDA), length)[,2]
  a4 <- 1-pt( sqrt(a3)*(a1[,2]-6)/a2,sqrt(a3))
  a5 <- ifelse( a4 < .05,'(*)','')
  a6 <- NULL
  for(j in 1:length(a5)) a6[j] <- paste(a1[j,2],a5[j], sep='')
  for(j in levels(data$RENDA)){
    if( sum( a1[,1] == j)  >0){
      id1 <- which(levels(data$RENDA) == j)
      id2 <- which(a1[,1] == j)
      
      r_aux[19+id1] <- a6[id2]
  }}
  
   a1 <- aggregate(aux$aceitacao, list(aux$POSTO), function(x) round(mean(x),2) )
  a2 <- aggregate(aux$aceitacao, list(aux$POSTO), sd)[,2]
  a3 <- aggregate(aux$aceitacao, list(aux$POSTO), length)[,2]
  a4 <- 1-pt( sqrt(a3)*(a1[,2]-6)/a2,sqrt(a3))
  a5 <- ifelse( a4 < .05,'(*)','')
  a6 <- NULL
  for(j in 1:length(a5)) a6[j] <- paste(a1[j,2],a5[j], sep='')
 for(j in levels(data$POSTO)){
    if( sum( a1[,1] == j)  >0){
      id1 <- which(levels(data$POSTO) == j)
      id2 <- which(a1[,1] == j)
      
      r_aux[24+id1] <- a6[id2]
  }}
  c_aux <- cbind( c_aux,r_aux)
}

Dtable <- data.frame( c(levels(data$IDADE),
                        levels(data$`ESTADO CIVIL`),
                        levels(data$ESCOLARIDADE),
                        levels(data$RENDA),
                        levels(data$POSTO)), c_aux)

names(Dtable) <- c('Perfil',1:13)

ktable <- kable(Dtable,caption = 'Tabela 4. Aceitação por cardápio de café da manhã por perfil do participante') %>%
  kable_classic(bootstrap_options = 'basic') %>%
  group_rows('Idade', 1,4) %>%
  group_rows('Estado civil',5,9) %>%
  group_rows('Grau de instrução',10,19) %>%
  group_rows('Renda familiar',20,24) %>%
  group_rows('Posto',25,29) %>%
  footnote( general = 'Colunas: (1) Balas de goma, (2) Bananada (3) Barra de proteína, (4) Bebida láctea - chocolate, (5) Bebida láctea - salada de frutas, (6) Biscoito cream cracker, (7) Café com leite, (8) Café solúvel, (9) Geleia de goiaba, (10) Geleia de morango, (11) Rapadura, (12) Refresco de fruta em pós, (13) Repositor hidroeletrolítico')
  

ktable
```

## Avaliação do perfil de aceitação dos cardápios (almoço/jantar) de rações operacionais em diferentes ambientes operacionais/regionais

```{r, echo = F}
setwd('C:/Users/jam_d/Documents/Consultorias/Victor')
data   <- read.csv('bancoAlmoco.csv', sep = ',', header = T, encoding = 'latin-1')
perfil <- read.csv('perfil.csv', sep = ',', header = T)
data$IDADE <- NA
data$`ESTADO CIVIL` <- NA
data$ESCOLARIDADE <- NA
data$RENDA <- NA
data$REGIAO <- NA
data$AMBIENTE <- NA
data$POSTO <- NA

ID_data <- unique( data$ID)
i <- ID_data[1]
for(i in ID_data){
  data$IDADE[data$ID == i] <- perfil$IDADE[perfil$ID == i]
  data$`ESTADO CIVIL`[data$ID == i] <- perfil$ESTADO.CIVIL[perfil$ID == i]
  data$ESCOLARIDADE[data$ID == i] <- perfil$ESCOLARIDADE [perfil$ID == i]
  data$RENDA[data$ID == i] <- perfil$RENDA[perfil$ID == i]
  data$REGIAO[data$ID == i] <- perfil$REGIAO [perfil$ID == i]
  data$AMBIENTE[data$ID == i] <- perfil$AMBIENTE[perfil$ID == i]
  data$POSTO[data$ID == i] <- perfil$POSTO[perfil$ID == i]
}

data$REGIAO <- as.factor(data$REGIAO)
  levels(data$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')

data$AMBIENTE <- as.factor(data$AMBIENTE)
  levels(data$AMBIENTE) <- c('Caatinga',
 'Selva',
 'Pantanal',
'Montanha',
 'Nenhuma das alternativas')

  
data$IDADE <- as.factor(data$IDADE)
levels(data$IDADE) <- c('18-25','26-35','36-45','>45')

data$`ESTADO CIVIL` <- as.factor(data$`ESTADO CIVIL`)
levels(data$`ESTADO CIVIL`) <- c('Solteiro','União estável','Casado','Divorciado')

data$ESCOLARIDADE <- as.factor(data$ESCOLARIDADE)
levels(data$ESCOLARIDADE) <- c(
  'Sem escolaridade',
'Ensino Fundamental Incompleto',
'Ensino Fundamental Completo',
'Ensino Médio Incompleto',
'Ensino Médio Completo',
'Ensino Técnico',
'Ensino Superior Incompleto',
'Ensino Superior Completo',
'Pós-graduação',
'Prefiro não mencionar'
)

data$RENDA <- as.factor(data$RENDA)
levels(data$RENDA) <- c(
  'Até 1 salário mínimo',
'Entre 2 e 5 salários mínimos',
'Entre 6 e 10 salários mínimos',
'Acima de 10 salários mínimos',
'Prefiro não informar')

data$POSTO <- as.factor(data$POSTO)
levels(data$POSTO) <- c(
  'Aluno',
 'Cb/Sd',
 'St/Sgt',
'Cap/Ten/ Asp',
'Of Superior'
)



```

A Tabela 5 apresenta a aceitação média dos cardápios de almoço/jantar. No geral, os cardápios `Arroz`, `Carne bovina ao molho goulash` e `Vaca atolada` não são bem aceitos.

```{r echo = F}
D <- aggregate( data$aceitacao, list(data$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( data$aceitacao, list(data$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( data$aceitacao, list(data$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

require(magrittr)

ktable <- kable(Dtable, caption = 'Tabela 5. Aceitação por cardápio de almoço/jantar') %>%
  kable_classic(bootstrap_options = 'basic')

ktable
```

```{r figure2-plot, dev = 'png', fig.show='hide',echo = F}
D <- aggregate( data$aceitacao, list(data$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( data$aceitacao, list(data$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( data$aceitacao, list(data$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

#Dtable$Cardápio[3] <- 'Barra de proteína'
#Dtable$Cardápio[5] <- 'Bebida láctea - sld. de frutas'
#Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,11),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Almoço e Jantar')
for(i in 1:11){
  symbols(1:11,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:11-1/5,rep(1/3,11),Dtable$Cardápio,srt = 90, cex = .7, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,12),labels=c('',''))
```

![Figura 12. Aceitação média do cardápio de almoço/jantar. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure2-plot','png')`)

A Tabela 6 apresenta a aceitação por região. Destacam-se as seguintes diferenças regionais:

-   *Norte e Sudeste*: se comporta como a Tabela 5.

-   *Nordeste*: apenas 3 cardápios são bem aceitos: `arroz com feijão`, `carne moída com batata` e `farinha de mandioca`.

-   *Centro-Oeste:* não são bem aceitos os cardápios `arroz`, `carne bovina com molho goulash`, `carve bovina com legumes`, `feijão com linguiça` e `vaca atolada`

-   *Sul*: se comporta como o Centro-Oeste, adicionando `feijoada` aos cardápios não bem aceitos.

```{r echo = F}
D <- aggregate( data$aceitacao, list(data$cardapio,data$REGIAO), function(x) round(mean(x),2))
Dm <- D[,3]
Ds <- aggregate( data$aceitacao, list(data$cardapio,data$REGIAO), function(x) round(sd(x),2))[,3]
Dn <- aggregate( data$aceitacao, list(data$cardapio,data$REGIAO), function(x) length(x))[,3]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1:2], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio - café da manhã','Região','Média','Desvio padrão','Estatística Z','p-valor')

require(magrittr)

ktable <- kable(Dtable[,-2],caption = 'Tabela 6. Aceitação por cardápio de almoço/jantar') %>%
  kable_classic(bootstrap_options = 'basic') %>%
  group_rows('Norte', 1,11) %>%
  group_rows('Nordeste',12,22) %>%
  group_rows('Centro-Oeste',23,33) %>%
  group_rows('Sudeste',34,44) %>%
  group_rows('Sul',45,55) 
  

ktable
```


As Figuras 13 a 17 apresentam os dados da Tabela 6.


```{r figure2-norte-plot, dev = 'png', fig.show='hide',echo = F}
dataNorte <- data[data$REGIAO == 'Norte',]
D <- aggregate( dataNorte$aceitacao, list(dataNorte$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataNorte$aceitacao, list(dataNorte$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataNorte$aceitacao, list(dataNorte$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

#Dtable$Cardápio[3] <- 'Barra de proteína'
#Dtable$Cardápio[5] <- 'Bebida láctea - sld. de frutas'
#Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,11),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Almoço e Jantar - região Norte')
for(i in 1:11){
  symbols(1:11,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:11-1/5,rep(1/3,11),Dtable$Cardápio,srt = 90, cex = .7, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,12),labels=c('',''))
```

```{r figure2-nordeste-plot, dev = 'png', fig.show='hide',echo = F}
dataNordeste <- data[data$REGIAO == 'Nordeste',]
D <- aggregate( dataNordeste$aceitacao, list(dataNordeste$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataNordeste$aceitacao, list(dataNordeste$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataNordeste$aceitacao, list(dataNordeste$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

#Dtable$Cardápio[3] <- 'Barra de proteína'
#Dtable$Cardápio[5] <- 'Bebida láctea - sld. de frutas'
#Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,11),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Almoço e Jantar - região Nordeste')
for(i in 1:11){
  symbols(1:11,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:11-1/5,rep(1/3,11),Dtable$Cardápio,srt = 90, cex = .7, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,12),labels=c('',''))
```

```{r figure2-co-plot, dev = 'png', fig.show='hide',echo = F}
dataco <- data[data$REGIAO == 'Centro-Oeste',]
D <- aggregate( dataco$aceitacao, list(dataco$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataco$aceitacao, list(dataco$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataco$aceitacao, list(dataco$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

#Dtable$Cardápio[3] <- 'Barra de proteína'
#Dtable$Cardápio[5] <- 'Bebida láctea - sld. de frutas'
#Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,11),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Almoço e Jantar - região Centro-Oeste')
for(i in 1:11){
  symbols(1:11,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:11-1/5,rep(1/3,11),Dtable$Cardápio,srt = 90, cex = .7, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,12),labels=c('',''))
```

```{r figure2-sudeste-plot, dev = 'png', fig.show='hide',echo = F}
dataSudeste <- data[data$REGIAO == 'Sudeste',]
D <- aggregate( dataSudeste$aceitacao, list(dataSudeste$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataSudeste$aceitacao, list(dataSudeste$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataSudeste$aceitacao, list(dataSudeste$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

#Dtable$Cardápio[3] <- 'Barra de proteína'
#Dtable$Cardápio[5] <- 'Bebida láctea - sld. de frutas'
#Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,11),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Almoço e Jantar - região Sudeste')
for(i in 1:11){
  symbols(1:11,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:11-1/5,rep(1/3,11),Dtable$Cardápio,srt = 90, cex = .7, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,12),labels=c('',''))
```

```{r figure2-sul-plot, dev = 'png', fig.show='hide',echo = F}
dataNorte <- data[data$REGIAO == 'Sul',]
D <- aggregate( dataNorte$aceitacao, list(dataNorte$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataNorte$aceitacao, list(dataNorte$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataNorte$aceitacao, list(dataNorte$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

#Dtable$Cardápio[3] <- 'Barra de proteína'
#Dtable$Cardápio[5] <- 'Bebida láctea - sld. de frutas'
#Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,11),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Almoço e Jantar - região Sul')
for(i in 1:11){
  symbols(1:11,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:11-1/5,rep(1/3,11),Dtable$Cardápio,srt = 90, cex = .7, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,12),labels=c('',''))
```

![Figura 13. Aceitação média do cardápio de almoço/jantar considerando a região Norte. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure2-norte-plot','png')`)

![Figura 14. Aceitação média do cardápio de almoço/jantar considerando a região Nordeste. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure2-nordeste-plot','png')`)

![Figura 15. Aceitação média do cardápio de almoço/jantar considerando a região Centro-Oeste. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure2-co-plot','png')`)

![Figura 16. Aceitação média do cardápio de almoço/jantar considerando a região Sudeste. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure2-sudeste-plot','png')`)

![Figura 17. Aceitação média do cardápio de almoço/jantar considerando a região Sul. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure2-sul-plot','png')`)


A Tabela 7 mostra a aceitação média dos cardápios de almoço/jantar nos ambientes. Destacamos:

-   *Caatinga*: são bem aceitos: `arroz`, `arroz com feijão`, `carne moída com batata` e `farinha de mandioca`.

-   *Selva*: não são bem aceitos a `carne bovina ao molho goulash` e a `vaca atolada`.

-   *Pantanal*: são bem aceitos a `carne moída com batata`, a `farinha de mandioca`, o `picadinho de carne bovina ao molho` e o `strognoff de carne`.

-   *Montanha*: são bem aceitos a `carne moída com batata`, a `feijoada`, o `picadinho de carne bovina ao molho` e o `strognoff de carne`.

-   *Outros*: se comporta com a Tabela 5.

```{r echo = F}
D <- aggregate( data$aceitacao, list(data$cardapio,data$AMBIENTE), function(x) round(mean(x),2))
Dm <- D[,3]
Ds <- aggregate( data$aceitacao, list(data$cardapio,data$AMBIENTE), function(x) round(sd(x),2))[,3]
Dn <- aggregate( data$aceitacao, list(data$cardapio,data$AMBIENTE), function(x) length(x))[,3]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1:2], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio - almoço/jantar','Ambiente','Média','Desvio padrão','Estatística Z','p-valor')

require(magrittr)

ktable <- kable(Dtable[,-2],caption = 'Tabela 7. Aceitação por cardápio de almoço/jantar') %>%
  kable_classic(bootstrap_options = 'basic') %>%
  group_rows('Caating', 1,11) %>%
  group_rows('Selva',12,22) %>%
  group_rows('Pantanal',23,33) %>%
  group_rows('Montanha',34,44) %>%
  group_rows('Outro',45,55) 
  

ktable
```


As Figuras 18 a 22 representam os dados da Tabela 7.

```{r figure2-caatinga-plot, dev = 'png', fig.show='hide',echo = F}
dataAmb <- data[data$AMBIENTE == 'Caatinga',]
D <- aggregate( dataAmb$aceitacao, list(dataAmb$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataAmb$aceitacao, list(dataAmb$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataAmb$aceitacao, list(dataAmb$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

#Dtable$Cardápio[3] <- 'Barra de proteína'
#Dtable$Cardápio[5] <- 'Bebida láctea - sld. de frutas'
#Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,11),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Almoço e Jantar - Caatinga')
for(i in 1:11){
  symbols(1:11,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:11-1/5,rep(1/3,11),Dtable$Cardápio,srt = 90, cex = .7, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,12),labels=c('',''))
```

```{r figure2-selva-plot, dev = 'png', fig.show='hide',echo = F}
dataAmb <- data[data$AMBIENTE == 'Selva',]
D <- aggregate( dataAmb$aceitacao, list(dataAmb$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataAmb$aceitacao, list(dataAmb$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataAmb$aceitacao, list(dataAmb$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

#Dtable$Cardápio[3] <- 'Barra de proteína'
#Dtable$Cardápio[5] <- 'Bebida láctea - sld. de frutas'
#Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,11),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Almoço e Jantar - Selva')
for(i in 1:11){
  symbols(1:11,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:11-1/5,rep(1/3,11),Dtable$Cardápio,srt = 90, cex = .7, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,12),labels=c('',''))
```

```{r figure2-pantanal-plot, dev = 'png', fig.show='hide',echo = F}
dataAmb <- data[data$AMBIENTE == 'Pantanal',]
D <- aggregate( dataAmb$aceitacao, list(dataAmb$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataAmb$aceitacao, list(dataAmb$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataAmb$aceitacao, list(dataAmb$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

#Dtable$Cardápio[3] <- 'Barra de proteína'
#Dtable$Cardápio[5] <- 'Bebida láctea - sld. de frutas'
#Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,11),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Almoço e Jantar - Pantanal')
for(i in 1:11){
  symbols(1:11,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:11-1/5,rep(1/3,11),Dtable$Cardápio,srt = 90, cex = .7, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,12),labels=c('',''))
```

```{r figure2-montanha-plot, dev = 'png', fig.show='hide',echo = F}
dataAmb <- data[data$AMBIENTE == 'Montanha',]
D <- aggregate( dataAmb$aceitacao, list(dataAmb$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataAmb$aceitacao, list(dataAmb$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataAmb$aceitacao, list(dataAmb$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

#Dtable$Cardápio[3] <- 'Barra de proteína'
#Dtable$Cardápio[5] <- 'Bebida láctea - sld. de frutas'
#Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,11),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Almoço e Jantar - Montanha')
for(i in 1:11){
  symbols(1:11,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:11-1/5,rep(1/3,11),Dtable$Cardápio,srt = 90, cex = .7, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,12),labels=c('',''))
```

```{r figure2-outro-plot, dev = 'png', fig.show='hide',echo = F}
dataAmb <- data[data$AMBIENTE == 'Nenhuma das alternativas',]
D <- aggregate( dataAmb$aceitacao, list(dataAmb$cardapio), function(x) round(mean(x),2))
Dm <- D[,2]
Ds <- aggregate( dataAmb$aceitacao, list(dataAmb$cardapio), function(x) round(sd(x),2))[,2]
Dn <- aggregate( dataAmb$aceitacao, list(dataAmb$cardapio), function(x) length(x))[,2]
Dt <- round(sqrt(Dn)*(Dm - 6)/Ds,2)
Dp <- round(1- pnorm(Dt),3)
Dast <- ifelse(Dp<.05,'*','')
Df <- Dp
for(i in 1:length(Dp)) Df[i] <- paste(ifelse(Dp[i]==0,'<.001',ifelse(Dp[i]==1,.999,Dp[i])),Dast[i])

Dtable <- data.frame(D[,1], Dm,Ds,Dt,Df)
names(Dtable) <- c('Cardápio','Média','Desvio padrão','Estatística Z','p-valor')

#Dtable$Cardápio[3] <- 'Barra de proteína'
#Dtable$Cardápio[5] <- 'Bebida láctea - sld. de frutas'
#Dtable$Cardápio[12] <- 'Refresco de fruta em pó'


plot.new()
plot.window(xlim=c(1,11),ylim=c(0,9))
title(ylab= 'Aceitação',xlab= 'Cardápio/Almoço e Jantar - outros')
for(i in 1:11){
  symbols(1:11,Dtable$Média/2, rectangles = as.matrix(cbind(2/3,Dtable$Média)), add = T, inches = F, bg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'),
          fg = ifelse(Dtable$`p-valor`<.05,'lightblue','tomato'))  
}
text(1:11-1/5,rep(1/3,11),Dtable$Cardápio,srt = 90, cex = .7, pos = 4)
axis(2,at = 0:9,labels = 0:9)
axis(1, at=c(0,12),labels=c('',''))
```


![Figura 18. Aceitação média do cardápio de almoço/jantar considerando o ambiente operacional Caatinga. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure2-caatinga-plot','png')`)

![Figura 19. Aceitação média do cardápio de almoço/jantar considerando o ambiente operacional Selva. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure2-selva-plot','png')`)

![Figura 20. Aceitação média do cardápio de almoço/jantar considerando o ambiente operacional Pantanal As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure2-pantanal-plot','png')`)

![Figura 21. Aceitação média do cardápio de almoço/jantar considerando o ambiente operacional Montanha As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure2-montanha-plot','png')`)

![Figura 22. Aceitação média do cardápio de almoço/jantar considerando os demais ambientes operacionais. As barras azuis mostram os cardápios com média maior que 6 considerando um nível de significância de 5%, enquanto que as vermelhas mostram os cadápios menos desejados.](`r knitr::fig_chunk('figure2-caatinga-plot','png')`)  




  A Tabela 8 apresenta a média da aceitação para cada cardápio e variável de perfil do participante. O símbolo (\*) representa que a média é maior que 6 (utilizou-se o teste $t$, porque algumas categorias possuem tamanho de amostra pequeno). Indivíduos com `pós-graduação` ou `divorciados` tendem a aceitar menos os cardápios em geral.

```{r echo = F}
levels(data$cardapio) <- c(
'Arroz',	
'Arroz com feijão e carne',	
'Carne bovina ao molho goulash',	
'Carne bovina com legumes',	
'Carne moída com batata',	
'Farinha de mandioca',	
'Feijão com linguiça',	
'Feijoada',	
'Picadinho de carne bovina ao molho',	
'Strogonoff de carne',
'Vaca Atolada'
)
card <- levels(data$cardapio)
c_aux <- NULL
for(i in 1:length(card)){
  r_aux <- rep(0,28)
  aux <- data[data$cardapio == card[i],]
  a1 <- aggregate(aux$aceitacao, list(aux$IDADE), function(x) round(mean(x),2) )
  a2 <- aggregate(aux$aceitacao, list(aux$IDADE), sd)[,2]
  a3 <- aggregate(aux$aceitacao, list(aux$IDADE), length)[,2]
  a4 <- 1-pt( sqrt(a3)*(a1[,2]-6)/a2,sqrt(a3))
  a5 <- ifelse( a4 < .05,'(*)','')
  a6 <- NULL
  for(j in 1:length(a5)) a6[j] <- paste(a1[j,2],a5[j], sep='')
  for(j in levels(data$IDADE)){
    if( sum( a1[,1] == j)  >0){
      id1 <- which(levels(data$IDADE) == j)
      id2 <- which(a1[,1] == j)
      
      r_aux[id1] <- a6[id2]
  }}

  a1 <- aggregate(aux$aceitacao, list(aux$`ESTADO CIVIL`), function(x) round(mean(x),2) )
  a2 <- aggregate(aux$aceitacao, list(aux$`ESTADO CIVIL`), sd)[,2]
  a3 <- aggregate(aux$aceitacao, list(aux$`ESTADO CIVIL`), length)[,2]
  a4 <- 1-pt( sqrt(a3)*(a1[,2]-6)/a2,sqrt(a3))
  a5 <- ifelse( a4 < .05,'(*)','')
  a6 <- NULL
  for(j in 1:length(a5)) a6[j] <- paste(a1[j,2],a5[j], sep='')
  for(j in levels(data$`ESTADO CIVIL`)){
    if( sum( a1[,1] == j)  >0){
      id1 <- which(levels(data$`ESTADO CIVIL`) == j)
      id2 <- which(a1[,1] == j)
      
      r_aux[4+id1] <- a6[id2]
    }}
    
  a1 <- aggregate(aux$aceitacao, list(aux$ESCOLARIDADE), function(x) round(mean(x),2) )
  a2 <- aggregate(aux$aceitacao, list(aux$ESCOLARIDADE), sd)[,2]
  a3 <- aggregate(aux$aceitacao, list(aux$ESCOLARIDADE), length)[,2]
  a4 <- 1-pt( sqrt(a3)*(a1[,2]-6)/a2,sqrt(a3))
  a5 <- ifelse( a4 < .05,'(*)','')
  a6 <- NULL
  for(j in 1:length(a5)) a6[j] <- paste(a1[j,2],a5[j], sep='')
  for(j in levels(data$ESCOLARIDADE)){
    if( sum( a1[,1] == j)  >0){
      id1 <- which(levels(data$ESCOLARIDADE) == j)
      id2 <- which(a1[,1] == j)
      r_aux[8+id1] <- a6[id2]
    }}
    
   a1 <- aggregate(aux$aceitacao, list(aux$RENDA), function(x) round(mean(x),2) )
  a2 <- aggregate(aux$aceitacao, list(aux$RENDA), sd)[,2]
  a3 <- aggregate(aux$aceitacao, list(aux$RENDA), length)[,2]
  a4 <- 1-pt( sqrt(a3)*(a1[,2]-6)/a2,sqrt(a3))
  a5 <- ifelse( a4 < .05,'(*)','')
  a6 <- NULL
  for(j in 1:length(a5)) a6[j] <- paste(a1[j,2],a5[j], sep='')
  for(j in levels(data$RENDA)){
    if( sum( a1[,1] == j)  >0){
      id1 <- which(levels(data$RENDA) == j)
      id2 <- which(a1[,1] == j)
      
      r_aux[18+id1] <- a6[id2]
  }}
  
   a1 <- aggregate(aux$aceitacao, list(aux$POSTO), function(x) round(mean(x),2) )
  a2 <- aggregate(aux$aceitacao, list(aux$POSTO), sd)[,2]
  a3 <- aggregate(aux$aceitacao, list(aux$POSTO), length)[,2]
  a4 <- 1-pt( sqrt(a3)*(a1[,2]-6)/a2,sqrt(a3))
  a5 <- ifelse( a4 < .05,'(*)','')
  a6 <- NULL
  for(j in 1:length(a5)) a6[j] <- paste(a1[j,2],a5[j], sep='')
 for(j in levels(data$POSTO)){
    if( sum( a1[,1] == j)  >0){
      id1 <- which(levels(data$POSTO) == j)
      id2 <- which(a1[,1] == j)
      
      r_aux[23+id1] <- a6[id2]
  }}
  c_aux <- cbind( c_aux,r_aux)
}

Dtable <- data.frame( c(levels(data$IDADE),
                        levels(data$`ESTADO CIVIL`),
                        levels(data$ESCOLARIDADE),
                        levels(data$RENDA),
                        levels(data$POSTO)), c_aux)

names(Dtable) <- c('Perfil',1:11)

ktable <- kable(Dtable,caption = 'Tabela 4. Aceitação por cardápio de almoço/jantar por perfil do participante') %>%
  kable_classic(bootstrap_options = 'basic') %>%
  group_rows('Idade', 1,4) %>%
  group_rows('Estado civil',5,8) %>%
  group_rows('Grau de instrução',9,18) %>%
  group_rows('Renda familiar',19,23) %>%
  group_rows('Posto',24,28) %>%
  footnote( general = 'Colunas: (1) Arroz, (2) Arroz com feijão e carne, (3) Carne bovina ao molho goulash, (4) Carne bovina com legumes, (5) Carne moída com batata, (6) Farinha de mandioca,	
(7) Feijão com linguiça, (8) Feijoada, (9) Picadinho de carne bovina ao molho, (10) Strogonoff de carne,(11) Vaca Atolada')
  

ktable
```

## Análise anterior

## 1. Metodologia

Neste relatório estão apresentadas as análises entre aceitação e consumo de cada cardápio. Abaixo são descritas as ferramentas que foram utilizadas.

### 1.1 Box-plot

O box-plot é uma ferramenta gráfica que constrói uma caixa utilizandos o primeiro e o terceiro quartil dos dados (i.é, os valores que acumulam abaixo deles 25% e 75% da amostra, respectivamente). Dentro da caixa há um traço que marca a mediana. Os traços fora da caixa são denominados "bigodes" e contém cerca de 99% dos dados quando a distribuição é normal. A imagem abaixo ilustra esses elementos

```{r echo = FALSE}
aceitação <- data$aceitacao
consumo   <- data$consumo

boxplot(aceitação, ylab = 'Aceitação', col=0, lwd=2)
text(.7,median(aceitação), 'Mediana', cex = 1.3)
text(.7,quantile(aceitação,.75), 'Quartil 3', cex = 1.3)
text(.7,quantile(aceitação,.25), 'Quartil 1', cex = 1.3)


```

Neste relatório em particular, os bigodes são irrelevantes. Estamos interessados em observar como as caixas, que contém a maior densidade dos dados, variam de acordo com o consumo e outras variáveis

### 1.2 O teste Qui-quadrado de Pearson para independência

Considere que duas variáveis discretas ou categóricas foram observadas simultaneamente (como, por exemplo, aceitação e consumo). O teste Qui-quadrado de Pearson testa se as duas variáveis são independentes. Especificamente:

-   A hipótese nula é: as variáveis são independentes.

-   Um p-valor pequeno (por exemplo, menor que 0,05) dá evidências que a hipótese nula é falsa, ou seja, a independência é descartada

-   Um p-valor maior que 0,05 não dá evidências contra a hipótese nula.

### 1.3 Os testes Kruskal-Wallis e Dunn

Considere que observamos amostras da mesma variável em populações distintas (por exemplo, a aceitação seria a variável e cada região uma população). O teste de Kruskal-Wallis testa se as populações tem a mesma distribuição. Existem dois desfechos:

-   Se o p-valor for maior que 0,05, não temos evidências contra a equidade de distribuição. Neste caso, assumimos que as populações são iguais (em relação à variável).

-   Se o p-valor é menor que 0,05, então há evidências de que pelo menos uma distribuição é distinta das demais.

O segundo desfecho acima é importante, pois diz que há diferença. Entretanto, o teste não informa os grupos de populações que são iguais ou distintos. Vou te dar a minha opinião pessoal sobre o assunto e o que você deve fazer para não ter dor de cabeça na defesa.

**Opinião pessoal**: Compare os box-plots e veja o que faz sentido para você. Por exemplo, com um boxplot por população, dá para ver se a mediana de uma população é muito diferente das outras. Se todas as medianas estão próximas, veja o comprimento do boxplot - se houver um diferente dos demais, a diferença está na variabilidade. Por ultimo, compare a posição entre os quartis - se forem diferentes, pode haver uma diferença de média e/ou desvio padrão.

**Solução padrão**: se você usar a minha opinião, vão dizer que você deveria ter feito um teste adicional. Então, vamos lá: se o p-valor do teste de Kruskal-Wallis é menor que 0,05, é usual fazer o teste de Dunn para cada par de populações - um teste para apontar as diferenças. Vou ilustrar alguns cenários considerando que o teste de Kruskal-Wallis para as populações A, B e C teve um p-valor \<0,05:

-   Os p-valores das comparações A-B, A-C e B-C são menores que 0,05, então as 3 populações são diferentes:

-   Se o p-valor da comparação A-B é maior que 0,05 e o p-valor de A-C e B-C são menores, então A e B tem a mesma distribuição, mas C é distinta das demais

-   Se os p-valores de A-B, A-C e B-C são maiores que 0,05, o teste falha em encontrar as diferenças.

-   Se os p-valores das comparações A-B e B-C são maiores que 0,05, mas o p-valor de A-C é menor, então a interpretação é confusa, pois A=B, B=C, mas A e C são diferentes. Por exemplo, pode ser que, no boxplot, você veja que a mediana de A é um pouco menor que a de B e esta é um pouco menos que a de C. Isso pode fazer com que A=B, B=C, mas se você comparar a mediana de A com C, essa distância é maior.

**Por que eu não gosto da solução padrão:** o problema é que muitos testes de hipóteses estão sendo feitos dentro do mesmo problema. Considerando o nível de significância de 0,05, cada teste que uma chance de 1/20 de dizer que tem diferença quando não há. Logo, ao avaliar vários p-valores simultaneamente, mesmo com correção (eu usei o método de Holm para corrigí-los), as chances de cometer erros aumentam.

**Nota**: alguns pesquisadores gostam de usar o teste de Tukey, no lugar do teste de Dunn. Não faz muita diferença usar um ou outro.

## 2. Relação entre aceitação e consumo para cada cardápio

Abaixo são apresentados os box-plots dos referidos cardápios. Note o padrão de crescimento das caixas, evidenciando que a aceitação é diretamente proporcional ao consumo. O teste qui-quadrado apresentou um p-valor menor que 0,001 para todos os cardápios, o que corrobora com a hipótese de proporcionalidade (uma vez que a hipótese de independência é descartada).

Aqui estão os boxplots para o café da manhã e ceia.

```{r, echo = F}
setwd('C:/Users/jam_d/Documents/Consultorias/Victor')
data   <- read.csv('banco.csv', sep = ',', header = T, encoding = 'UTF-8')
data2   <- read.csv('bancoAlmoco.csv', sep = ',', header = T, encoding = 'UTF-8')

perfil <- read.csv('perfil.csv', sep = ',', header = T)
data$IDADE <- NA
data$`ESTADO CIVIL` <- NA
data$ESCOLARIDADE <- NA
data$RENDA <- NA
data$REGIAO <- NA
data$AMBIENTE <- NA
data$POSTO <- NA

data2$IDADE <- NA
data2$`ESTADO CIVIL` <- NA
data2$ESCOLARIDADE <- NA
data$RENDA <- NA
data2$REGIAO <- NA
data2$AMBIENTE <- NA
data2$POSTO <- NA


ID_data <- unique( data$ID)
i <- ID_data[1]
for(i in ID_data){

  data$IDADE[data$ID == i] <- perfil$IDADE[perfil$ID == i]
  data$`ESTADO CIVIL`[data$ID == i] <- perfil$ESTADO.CIVIL[perfil$ID == i]
  data$ESCOLARIDADE[data$ID == i] <- perfil$ESCOLARIDADE [perfil$ID == i]
  data$RENDA[data$ID == i] <- perfil$RENDA[perfil$ID == i]
  data$REGIAO[data$ID == i] <- perfil$REGIAO [perfil$ID == i]
  data$AMBIENTE[data$ID == i] <- perfil$AMBIENTE[perfil$ID == i]
  data$POSTO[data$ID == i] <- perfil$POSTO[perfil$ID == i]
}

ID_data <- unique( data2$ID)
i <- ID_data[1]
for(i in ID_data){
    data2$IDADE[data2$ID == i] <- perfil$IDADE[perfil$ID == i]
  data2$`ESTADO CIVIL`[data2$ID == i] <- perfil$ESTADO.CIVIL[perfil$ID == i]
  data2$ESCOLARIDADE[data2$ID == i] <- perfil$ESCOLARIDADE [perfil$ID == i]
  data2$RENDA[data2$ID == i] <- perfil$RENDA[perfil$ID == i]
  data2$REGIAO[data2$ID == i] <- perfil$REGIAO [perfil$ID == i]
  data2$AMBIENTE[data2$ID == i] <- perfil$AMBIENTE[perfil$ID == i]
  data2$POSTO[data2$ID == i] <- perfil$POSTO[perfil$ID == i]

}


```

##  {.tabset}

### Café com leite e açúcar

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 1
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valof do teste Qui-quadrado de Pearson :',pv)
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')

     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())


#}
```

### Barra de proteína - sabor cookies e cream

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 2
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')
  
     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())

#}
```

### Bebida láctea - salada de frutas

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 3
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')
  
     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())

#}
```

### Geleia de morango

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 4
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')
  
     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())

#}
```

### Biscoito cream cracker

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 5
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')
  
     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())

#}
```

### Café solúvel

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 6
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')
  
     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())

#}
```

### Rapadura

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 7
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')
  
     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())

#}
```

### Refresco de fruta em pó - sabores variados

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 8
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')
  
     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())

#}
```

### Repositor hidroeletrolítico

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 9
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')
  
     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())

#}
```

### Balas de goma (jujuba)

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 10
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')
  
     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())

#}
```

### Bebida láctea - chocolate

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 11
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')
  
     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())

#}
```

### Geleia de goiaba

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 12
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')
  

#}
```

### Bananada

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 13
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')
  
     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())

#}
```

##{-}

Aqui estão os gráficos e p-valores para os cardápios de almoço e jantar.

##  {.tabset}

### Vaca Atolada

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 1

#for(i in 1:13){
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')

     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())


#}
```

### Feijoada

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 2

#for(i in 1:13){
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')

     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())


#}
```

### Picadinho de carne bovina ao molho

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 3

#for(i in 1:13){
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')

     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())


#}
```

### Strogonoff de carne

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 4

#for(i in 1:13){
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')

     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())


#}
```

### Carne moída com batata

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 5

#for(i in 1:13){
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')

     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())


#}
```

### Arroz com feijão e carne

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 6

#for(i in 1:13){
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')

     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())


#}
```

### Carne bovina com legumes

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 7

#for(i in 1:13){
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')

     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())


#}
```

### Feijão com linguiça

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 8

#for(i in 1:13){
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')

     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())


#}
```

### Carne bovina ao molho goulash

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 9

#for(i in 1:13){
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')

     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())


#}
```

### Arroz

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 10

#for(i in 1:13){
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$consumo <- as.factor(dataCard$consumo)
  levels(dataCard$consumo) <- c('0-25%','26-50%','51-75%','76-100%') 
  boxplot(aceitacao ~consumo, data = dataCard,
          xlab = 'Consumo', ylab = 'Aceitação',
          names <- c('0-25%','26-50%','51-75%','76-100%'),
          col = brewer.pal(4,'Greens'), lwd = 2
          , main = card[i],sub = '')

     chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Qui-quadrado de Pearson :',pv)
  }
title( sub = chisqTexto())


#}
```

##  {.unnumbered}

## 3. A aceitação entre cardápios para as diferentes regiões

Como a relação entre aceitação e consumo é proporcional, podemos escolher apenas uma delas para comparar com as regiões. Aqui foi escolhida a aceitação, por estar em escala de Likert.

Foram construídos 5 boxplots, um por região, para a variável aceitação. Em seguida, foi realizado o teste de Kruskal-Wallis. Para aqueles com o p-valor menor que 0,05, foi realizado o teste de Dunn, cujos os resultados aparecem impressos abaixo do boxplot.

Em linhas gerais, a aceitação na região Norte é ligeramente maior que as demais regiões. Na maioria das comparações, a região Norte se mostrou parecida com a Nordeste, mas distinta das regiões Centro-Oeste, Sudeste e Sul. Alguns cardápios, em espacial os do almoço/jantar, não apresentaram diferenças entre as regiões.

Abaixo eu ajudo com algumas possíveis explicações para as diferenças entre as regiões por cardápio (café da manhã e ceia) ao utilizar o teste de Dunn:

-   Café com leite e açúcar: o terceiro quartil das regiões Centro Oeste e Sul são menores que a mediana da região Norte. Nessa comparção, a aceitação na região norte é maior

-   Bebida láctea - salada de frutas: a região Centro-Oeste é a que tem os 3 quartis mais distantes em relação à região Norte.

-   Biscoito cream-craker: não foi possível identificar as diferenças pelo teste de Dunn, mas o boxplot indica que a aceitação é maior na região Norte

-   Café solúvel: Norte e Sudeste tem os extremos das caixas mais distantes; Sudeste e Sul possuem a menor e a maior mediana.

-   Rapadura: não é muito clara a diferença entre Norte e Sudeste

-   Refresco de fruta em pó: não é muito clara a diferença entre Norte e Sul

-   Repositor hidroeletrolítico: não foi possível identificar as diferenças pelo teste de Dunn, mas o boxplot indica que a aceitação na região Norte está concentrada em 8 (uma vez que a mediana e o terceiro quartil são iguais)

-   Balas de goma: diferença entre Norte e Centro-Oeste não é visível.

-   Bebida láctea - chocolate: Centro-Oeste e Sudeste possuem medianas menores que o Norte. Analisando só este aspecto, Norte e Nordeste formam um grupo (com mediana 7) e as demais regiões outro grupo (com mediana 6)

-   Geleia de goiaba: o primeiro e terceiro quartil da região Norte são distintos quando comparados com Sudeste, Sul e Centro-Oeste

##  {.tabset}

### Café com leite e açúcar

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 1
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valof do teste Qui-quadrado de Pearson :',pv)
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],
dunn$pmat[1,4],
dunn$pmat[1,5],
dunn$pmat[2,3],
dunn$pmat[2,4],
dunn$pmat[2,5],
dunn$pmat[3,4],
dunn$pmat[3,5],
dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',
  'Norte Centro-Oeste',
  'Norte Sudeste',
  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',
  'Nordeste Sul',
  'Centro-Oeste Sudeste',
  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}








#}
```

### Barra de proteína - sabor cookies e cream

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 2
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valof do teste Qui-quadrado de Pearson :',pv)
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],
dunn$pmat[1,4],
dunn$pmat[1,5],
dunn$pmat[2,3],
dunn$pmat[2,4],
dunn$pmat[2,5],
dunn$pmat[3,4],
dunn$pmat[3,5],
dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',
  'Norte Centro-Oeste',
  'Norte Sudeste',
  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',
  'Nordeste Sul',
  'Centro-Oeste Sudeste',
  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}








#}
```

### Bebida láctea - salada de frutas

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 3
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valof do teste Qui-quadrado de Pearson :',pv)
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,3)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],
dunn$pmat[1,4],
dunn$pmat[1,5],
dunn$pmat[2,3],
dunn$pmat[2,4],
dunn$pmat[2,5],
dunn$pmat[3,4],
dunn$pmat[3,5],
dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',
  'Norte Centro-Oeste',
  'Norte Sudeste',
  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',
  'Nordeste Sul',
  'Centro-Oeste Sudeste',
  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}

#}
```

### Geleia de morango

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 4
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valof do teste Qui-quadrado de Pearson :',pv)
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],
dunn$pmat[1,4],
dunn$pmat[1,5],
dunn$pmat[2,3],
dunn$pmat[2,4],
dunn$pmat[2,5],
dunn$pmat[3,4],
dunn$pmat[3,5],
dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',
  'Norte Centro-Oeste',
  'Norte Sudeste',
  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',
  'Nordeste Sul',
  'Centro-Oeste Sudeste',
  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}








#}
```

### Biscoito cream cracker

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 5
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valof do teste Qui-quadrado de Pearson :',pv)
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],
dunn$pmat[1,4],
dunn$pmat[1,5],
dunn$pmat[2,3],
dunn$pmat[2,4],
dunn$pmat[2,5],
dunn$pmat[3,4],
dunn$pmat[3,5],
dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',
  'Norte Centro-Oeste',
  'Norte Sudeste',
  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',
  'Nordeste Sul',
  'Centro-Oeste Sudeste',
  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}








#}
```

### Café solúvel

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 6
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valof do teste Qui-quadrado de Pearson :',pv)
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],
dunn$pmat[1,4],
dunn$pmat[1,5],
dunn$pmat[2,3],
dunn$pmat[2,4],
dunn$pmat[2,5],
dunn$pmat[3,4],
dunn$pmat[3,5],
dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',
  'Norte Centro-Oeste',
  'Norte Sudeste',
  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',
  'Nordeste Sul',
  'Centro-Oeste Sudeste',
  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}








#}
```

### Rapadura

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 7
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valof do teste Qui-quadrado de Pearson :',pv)
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],
dunn$pmat[1,4],
dunn$pmat[1,5],
dunn$pmat[2,3],
dunn$pmat[2,4],
dunn$pmat[2,5],
dunn$pmat[3,4],
dunn$pmat[3,5],
dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',
  'Norte Centro-Oeste',
  'Norte Sudeste',
  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',
  'Nordeste Sul',
  'Centro-Oeste Sudeste',
  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}








#}
```

### Refresco de fruta em pó - sabores variados

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 8
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valof do teste Qui-quadrado de Pearson :',pv)
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],
dunn$pmat[1,4],
dunn$pmat[1,5],
dunn$pmat[2,3],
dunn$pmat[2,4],
dunn$pmat[2,5],
dunn$pmat[3,4],
dunn$pmat[3,5],
dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',
  'Norte Centro-Oeste',
  'Norte Sudeste',
  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',
  'Nordeste Sul',
  'Centro-Oeste Sudeste',
  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}








#}
```

### Repositor hidroeletrolítico

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 9
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valof do teste Qui-quadrado de Pearson :',pv)
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],
dunn$pmat[1,4],
dunn$pmat[1,5],
dunn$pmat[2,3],
dunn$pmat[2,4],
dunn$pmat[2,5],
dunn$pmat[3,4],
dunn$pmat[3,5],
dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',
  'Norte Centro-Oeste',
  'Norte Sudeste',
  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',
  'Nordeste Sul',
  'Centro-Oeste Sudeste',
  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}








#}
```

### Balas de goma (jujuba)

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 10
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valof do teste Qui-quadrado de Pearson :',pv)
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],
dunn$pmat[1,4],
dunn$pmat[1,5],
dunn$pmat[2,3],
dunn$pmat[2,4],
dunn$pmat[2,5],
dunn$pmat[3,4],
dunn$pmat[3,5],
dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',
  'Norte Centro-Oeste',
  'Norte Sudeste',
  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',
  'Nordeste Sul',
  'Centro-Oeste Sudeste',
  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}








#}
```

### Bebida láctea - chocolate

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 11
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valof do teste Qui-quadrado de Pearson :',pv)
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],
dunn$pmat[1,4],
dunn$pmat[1,5],
dunn$pmat[2,3],
dunn$pmat[2,4],
dunn$pmat[2,5],
dunn$pmat[3,4],
dunn$pmat[3,5],
dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',
  'Norte Centro-Oeste',
  'Norte Sudeste',
  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',
  'Nordeste Sul',
  'Centro-Oeste Sudeste',
  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}








#}
```

### Geleia de goiaba

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 12
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valof do teste Qui-quadrado de Pearson :',pv)
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],
dunn$pmat[1,4],
dunn$pmat[1,5],
dunn$pmat[2,3],
dunn$pmat[2,4],
dunn$pmat[2,5],
dunn$pmat[3,4],
dunn$pmat[3,5],
dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',
  'Norte Centro-Oeste',
  'Norte Sudeste',
  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',
  'Nordeste Sul',
  'Centro-Oeste Sudeste',
  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}








#}
```

### Bananada

```{r echo = FALSE, warning=FALSE}
card <- unique(data$cardapio)
i <- 13
  chisqTexto <- function(){
      x <-chisq.test(table(dataCard$consumo,dataCard$aceitacao ))
      pv <- x$p.value
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valof do teste Qui-quadrado de Pearson :',pv)
  }

#for(i in 1:13){
  dataCard <- data[data$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],
dunn$pmat[1,4],
dunn$pmat[1,5],
dunn$pmat[2,3],
dunn$pmat[2,4],
dunn$pmat[2,5],
dunn$pmat[3,4],
dunn$pmat[3,5],
dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',
  'Norte Centro-Oeste',
  'Norte Sudeste',
  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',
  'Nordeste Sul',
  'Centro-Oeste Sudeste',
  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}








#}
```

##  {.unnumbered}

Abaixo eu ajudo com algumas possíveis explicações para as diferenças entre as regiões por cardápio (almoço e jantar) ao utilizar o teste de Dunn:

-   Feijoada: a região Norte tem a maior preferência. Já Sudeste, Sul e Centro-Oeste são muito parecidos, com mediana menor que os demais.

-   Arroz com feijão e carne: curiosamente, o Nordeste tem a maior aceitação e é dito ser semelhante aos demais. Há diferença no primeiro quartil da região Norte com as regiões Sudeste, Centro-Oeste e Sul.

-   Carne bovina com legume: a diferença não é clara entre Norte e Centro-Oeste

-   Feijão com linguiça: a região Norte tem a maior preferência. Já Sudeste, Sul e Centro-Oeste são muito parecidos, com o primeiro quartil menor que os demais.

-   Arroz: todos os três quartis das regiões Centro-oeste e Sudeste são diferentes da região Norte.

##  {.tabset}

### Vaca Atolada

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 1
 
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],dunn$pmat[1,4],dunn$pmat[1,5],
dunn$pmat[2,3],dunn$pmat[2,4],dunn$pmat[2,5],
dunn$pmat[3,4],dunn$pmat[3,5],dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',  'Norte Centro-Oeste',
  'Norte Sudeste',  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',  'Nordeste Sul',
  'Centro-Oeste Sudeste',  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}
#}
```

### Feijoada

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 2
 
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],dunn$pmat[1,4],dunn$pmat[1,5],
dunn$pmat[2,3],dunn$pmat[2,4],dunn$pmat[2,5],
dunn$pmat[3,4],dunn$pmat[3,5],dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',  'Norte Centro-Oeste',
  'Norte Sudeste',  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',  'Nordeste Sul',
  'Centro-Oeste Sudeste',  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}
#}
```

### Picadinho de carne bovina ao molho

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 3
 
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],dunn$pmat[1,4],dunn$pmat[1,5],
dunn$pmat[2,3],dunn$pmat[2,4],dunn$pmat[2,5],
dunn$pmat[3,4],dunn$pmat[3,5],dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',  'Norte Centro-Oeste',
  'Norte Sudeste',  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',  'Nordeste Sul',
  'Centro-Oeste Sudeste',  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}
#}
```

### Strogonoff de carne

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 4
 
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],dunn$pmat[1,4],dunn$pmat[1,5],
dunn$pmat[2,3],dunn$pmat[2,4],dunn$pmat[2,5],
dunn$pmat[3,4],dunn$pmat[3,5],dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',  'Norte Centro-Oeste',
  'Norte Sudeste',  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',  'Nordeste Sul',
  'Centro-Oeste Sudeste',  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}
#}
```

### Carne moída com batata

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 5
 
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],dunn$pmat[1,4],dunn$pmat[1,5],
dunn$pmat[2,3],dunn$pmat[2,4],dunn$pmat[2,5],
dunn$pmat[3,4],dunn$pmat[3,5],dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',  'Norte Centro-Oeste',
  'Norte Sudeste',  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',  'Nordeste Sul',
  'Centro-Oeste Sudeste',  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}
#}
```

### Arroz com feijão e carne

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 6
 
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],dunn$pmat[1,4],dunn$pmat[1,5],
dunn$pmat[2,3],dunn$pmat[2,4],dunn$pmat[2,5],
dunn$pmat[3,4],dunn$pmat[3,5],dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',  'Norte Centro-Oeste',
  'Norte Sudeste',  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',  'Nordeste Sul',
  'Centro-Oeste Sudeste',  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}
#}
```

### Carne bovina com legumes

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 7
 
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],dunn$pmat[1,4],dunn$pmat[1,5],
dunn$pmat[2,3],dunn$pmat[2,4],dunn$pmat[2,5],
dunn$pmat[3,4],dunn$pmat[3,5],dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',  'Norte Centro-Oeste',
  'Norte Sudeste',  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',  'Nordeste Sul',
  'Centro-Oeste Sudeste',  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}
#}
```

### Feijão com linguiça

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 8
 
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],dunn$pmat[1,4],dunn$pmat[1,5],
dunn$pmat[2,3],dunn$pmat[2,4],dunn$pmat[2,5],
dunn$pmat[3,4],dunn$pmat[3,5],dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',  'Norte Centro-Oeste',
  'Norte Sudeste',  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',  'Nordeste Sul',
  'Centro-Oeste Sudeste',  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}
#}
```

### Carne bovina ao molho goulash

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 9
 
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],dunn$pmat[1,4],dunn$pmat[1,5],
dunn$pmat[2,3],dunn$pmat[2,4],dunn$pmat[2,5],
dunn$pmat[3,4],dunn$pmat[3,5],dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',  'Norte Centro-Oeste',
  'Norte Sudeste',  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',  'Nordeste Sul',
  'Centro-Oeste Sudeste',  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}
#}
```

### Arroz

```{r echo = FALSE, warning=FALSE}
card <- unique(data2$cardapio)
i <- 10
 
  dataCard <- data2[data2$cardapio == card[i], ]
  dataCard$REGIAO <- as.factor(dataCard$REGIAO)
  levels(dataCard$REGIAO) <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul')
  boxplot(aceitacao ~REGIAO, data = dataCard,
          xlab = 'Regiões', ylab = 'Aceitação',
          names <- c('Norte','Nordeste','Centro-Oeste','Sudeste', 'Sul'),
          col = brewer.pal(5,'Blues'), lwd = 2
          , main = card[i],sub = '')

# 
  kruskalTexto <- function(){
      x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO )
      pv <- round(x$p.value,2)
      if( x$p.value < 0.001) pv <- '<0.001'
   paste('p-valor do teste Kruskal-Wallis para diferenças entre populações :',pv)
  }
title( sub = kruskalTexto())
```

$\\$

```{r echo = F, warnings = F}
x <-kruskal.test(dataCard$aceitacao,dataCard$REGIAO) 

if( x$p.value < .05){
  dunn <- DunnTest( aceitacao ~ REGIAO, data = dataCard, method = 'holm')
pval <- round(
    c(dunn$pmat[1,2],
dunn$pmat[1,3],dunn$pmat[1,4],dunn$pmat[1,5],
dunn$pmat[2,3],dunn$pmat[2,4],dunn$pmat[2,5],
dunn$pmat[3,4],dunn$pmat[3,5],dunn$pmat[4,5])
,3)


dupla <- c(
  'Norte Nordeste',  'Norte Centro-Oeste',
  'Norte Sudeste',  'Norte Sul',
  'Nordeste Centro-Oeste',
  'Nordeste Sudeste',  'Nordeste Sul',
  'Centro-Oeste Sudeste',  'Centro-Oeste Sul',
  'Sudeste Sul')

decisao <- unlist(sapply(pval, function(x){
  if(x < .05){
    dec <- 'Distribuições diferentes'
  }else{ dec <- 'Mesma distribuição'} 
  dec
}))

df <- data.frame(dupla,pval,decisao)
names(df) <- c('Dupla','p-valor','Decisão')


dt <- df
dt <- kbl(dt)
dt <-   kable_classic(dt, full_width = F, html_font = "Cambria")
dt
  
}
#}
```
