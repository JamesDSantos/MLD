"0","require(dlm)"
"0",""
"0","modFim <- function(y,mod){"
"0","  ffbs <- dlmGibbsDIG(y, mod = mod, n.sample = 5000,"
"0","                    a.y=1,b.y=100,a.theta=1,b.theta=100,"
"0","                    save.states = FALSE, thin = 0)"
"0",""
"0","v_sim  <- sample(ffbs$dV[-(1:2500)],2500,T)"
"0",""
"0","q <- dim(ffbs$dW)[2]"
"0","w_sim <- NULL"
"0","for(j in 1:q){"
"0"," w_sim <- c(w_sim, mean(sample(ffbs$dW[,j][-(1:2500)],2500,T)))"
"0","}"
"0","# declarando as variâncias na quádrupla"
"0","mod$V <- mean(v_sim)"
"0","mod$W <- diag( w_sim)"
"0","return(mod)"
"0","}"
