{
  "hash": "c440aedf1b57bb205b5407b30d776357",
  "result": {
    "markdown": "# Introdução\n\n## Definição de séries temporais\n\nConsidere um fenômeno aleatório que será observado ao longo do tempo. A coleção de variáveis aleatórias indexadas no tempo associadas a este fenômeno será denominada série temporal. Neste caso, para cada instante de tempo $t$, há uma variável $X(t)$ associada.\n\n\n\n::: {.cell}\n\n:::\n\n\n\n![Figure 1 - Ilustração de uma série temporal](intro_files/figure-pdf/figura1-1.png)\n\nAlguns autores definem séries temporais simplesmente como uma os valores de uma variável registrados ao longo do tempo. Essa definição não é útil para nós, uma vez que o tempo não necessariamente possui influência na variável, ou seja, é possível que a distribuição de $X(t)$ não dependa de $t$.\n\n::: {.alert .alert-success}\n<strong>Importante</strong>: estamos interessados apenas em séries temporais nas quais o modelo de probabilidades depende do tempo $t$.\n:::\n\nA partir deste momento, $X(t)$ será escrita como $X_t$ e representará a variável aleatória associada ao tempo $t$ e a versão minúscula $x_t$ representará o valor observado.\n\n## A classe `ts`\n\nA tabela aabeixo apresenta o número de nascidos vivos por mês na cidade de Manaus em 2021.\n\n| Mês | No. nascidos vivos |\n|-----------|--------------|\n| Janeiro | 3043 |\n| Fevereiro | 2902 |\n| Março | 3166 |\n| Abril | 3014 |\n| Maio | 3095 |\n| Junho | 2955 |\n| Julho | 3087 |\n| Agosto | 3141 |\n| Setembro | 3129 |\n| Outubro | 3096 |\n| Novembro | 3191 |\n| Dezembro | 3222| \n\n\nPara todos os efeitos, uma série temporal é um vetor numérico. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- c(\n  3043, 2902, 3166, 3014,\n3095, 2955, 3087, 3141,\n3129, 3096, 3191, 3222\n\n)\n\nplot(x, type = 'l')\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/unnamed-chunk-1-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\nContudo, é útil construir a série temporal como um objeto da classe `ts`. Tal função possui dois argumentos importantes:\n\n* `frequency`: representa o número de observações por unidade de tempo. Por exemplo, se o tempo está sendo registrado em anos, mas o dados são mensais, então `frequency=12`.\n\n* `start`: representa o momento que a série começa. Pode ser representado um único número ou por um vetor de dois números, com o segundo \nrepresentando o momento dentro do período. Por exemplo `start=c(1996,2)` implica que a primeira observação data de fevereiro de 1996. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ny <- ts( x, start = c(2021,1), frequency = 12)\ny\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      Jan  Feb  Mar  Apr  May  Jun  Jul  Aug  Sep  Oct  Nov  Dec\n2021 3043 2902 3166 3014 3095 2955 3087 3141 3129 3096 3191 3222\n```\n:::\n\n```{.r .cell-code}\nts.plot(y)\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/unnamed-chunk-2-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\nNo gráfico acima, a parte decimal no eixo $x$  representa a fração do tempo entre de um ano (começando em 0 e acumulando 1/12 para cada mês subsequente). \n\nTambém podemos customizar o gráfico.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(y, ylab = 'No. nascidos vivos mensal', lwd = 2, col = 'seagreen')\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/unnamed-chunk-3-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\nA função `window` seleciona um subconjunto da  série temporal. Abaixo selecionamos apenas os nascimentos entre Junho e Agosto e marcamos estes valores no gráfico.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nz <- window(y, start=c(2021,6), end = c(2021,8))\n\nplot(y, ylab = 'No. nascidos vivos mensal', lwd = 2, col = 'seagreen')\nlines(z, col = 'brown', lwd= 2)\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/unnamed-chunk-4-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n<div class='alert alert-warning'>\n<strong>Exercício 1</strong>\nConsidere o total mensal de nascidos vivos na cidade de Manaus entre 2019 e 2020:\n\n| Ano | Mês | No. nascidos vivos |\n|-----|-----| -----|\n|2019 | 1 | 3.199|\n||2|2.963|\n||3|3.146|\n||4|2.966|\n||5|3.074|\n||6|2.919|\n||7|3.129|\n||8|3.230|\n||9|3.456|\n||10|3.486|\n||11|3.220|\n||12|3.151|\n|2020|1|3.185|\n||2|3.131|\n||3|3.256|\n||4|3.008|\n||5|3.080|\n||6|2.919|\n||7|3.208|\n||8|3.126|\n||9|3.126|\n||10|3.210|\n||11|2.957|\n||12|3.068|\n\n1. Construa um único vetor com os três anos apresentados\n\n2. A partir do vetor criado, construa um objeto do tipo `ts`\n\n3. Faça um gráfico da série.\n\n4. Crie um janela para ver apenas o ano de 2020.\n\n5. Represente a janela acima no gráfico anterior.\n\n</div>\n\n\n## O pacote `data.table`\n\nAssim como números e textos possuem classes específicas, as datas no ambiente `R` também possuem sua `Date`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 3 de agosto de 1998 (formato americano)\nx <- '1998/8/3'\nas.Date(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"1998-08-03\"\n```\n:::\n:::\n\n\n\nPara que o `R` entenda uma data no formato nacional, é necessário mudar o formato:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 3 de agosto de 1998 (formato nacional)\nx <- '3/8/1998'\nas.Date(x, format = '%d/%m/%Y')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"1998-08-03\"\n```\n:::\n:::\n\n\nLidamos com datas quando temos uma fonte de dados bruta, mas em geral nosso objetivo é determinar a quantidade de eventos dentro de dias, semanas, meses ou anos. O pacote `data.table` permite lidar com esse problema de modo rápido. Podemos criar um objeto deste tipo utilizando a função `fread`. A seguir, vamos baixar uma base de dados de acidentes com aeronaves, mantida pela Força Aérea Brasileira e transformar a data de formato nacional para a classe `Date`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(data.table)\nurl <- 'https://drive.google.com/uc?authuser=0&id=1iYrnwXgmLK07x8b330aD73scOVruZEuz&export=download'\n\naereo <-  fread(url, encoding = 'Latin-1')\naereo$ocorrencia_dia <- as.Date(aereo$ocorrencia_dia, '%d/%m/%Y')\n```\n:::\n\n\n\nUm objeto do tipo `data.table` permite uma série de consultas. Em geral, pode-se fazer `aereo[a,b,c]`, onde `a` é uma consulta/função nas linhas, `b` nas colunas e `c` é um agrupador. Uma excelente introdução pode ser vista em [Introduction to data.table](https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html). \n\nAbaixo, selecionamos apenas a coluna de interesse.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfab_dia <- aereo[,'ocorrencia_dia',]\nhead(fab_dia)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   ocorrencia_dia\n1:     2023-04-05\n2:     2023-06-24\n3:     2023-06-27\n4:     2023-06-30\n5:     2023-06-25\n6:     2023-06-23\n```\n:::\n:::\n\n\n\n Ao utilizar o operador `.N` em `[,.N,c]`, é retornado o número de linhas que possuem o agrupamento em `c`. Vamos agrupar as datas do nosso banco por ano.\n \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfab_ano <- fab_dia[, .N, by=.(year(ocorrencia_dia))]\nfab_ano <-fab_ano[ order(year) ]\nhead(fab_ano)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   year   N\n1: 2013 654\n2: 2014 569\n3: 2015 471\n4: 2016 403\n5: 2017 432\n6: 2018 444\n```\n:::\n:::\n\n\n\nAgora, podemos fazer o gráfico da série\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfab_ano <- ts( fab_ano, start = 2013)\nplot(fab_ano[,2], lwd = 2, ylab = 'No. acidentes/ano', xlab = 'Ano')\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/unnamed-chunk-10-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\nTambém podemos fazer uma série mensal:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfab_mes <- fab_dia[, .N, by=.(year(ocorrencia_dia), month(ocorrencia_dia))]\n\nfab_mes <-fab_mes[ order(year, month ) ]\nhead(fab_mes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   year month  N\n1: 2013     1 58\n2: 2013     2 60\n3: 2013     3 64\n4: 2013     4 60\n5: 2013     5 60\n6: 2013     6 49\n```\n:::\n:::\n\n\n\nO gráfico dessa nova série é:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfab_mes <- ts( fab_mes[,3], start = c(2013, 1), frequency = 12)\nplot(fab_mes, lwd = 2, ylab = 'No. acidentes/mês', xlab = 'Ano')\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/unnamed-chunk-12-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n     \n\n<div class='alert alert-warning'>\n<strong>Exercício 1</strong>\n\n\nA série abaixo contém a data dos óbitos maternos no Brasil a partir de 2010.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nurl <- 'https://drive.google.com/uc?authuser=0&id=1tYFFT9L2iopKmBDUI3P8qNIRaOnMYj7d&export=download'\n```\n:::\n\n\n\nCrie uma série temporal com o número de óbitos mensal e faça um gráfico. Crie uma janela para colocar no gráfico o período da pandemia de COVID-19.\n\n</div>\n\n\n\n",
    "supporting": [
      "intro_files\\figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}