{
  "hash": "e03257634e3644796fa7091196d302f4",
  "result": {
    "engine": "knitr",
    "markdown": "# Sinal, ruído e correlograma\n\n## Sinal e ruído\n\nEm geral, a série temporal possui componentes de dois tipos: sinal e ruído. O primeiro é uma função do tempo geralmente relacionado com a média da série em dado instante de tempo, enquanto que o segundo está relacionado com a variância. Podemos assumir que essa relação é aditiva:\n\n$$X_t=\\hbox{sinal}(t)+\\varepsilon_t$$ onde $\\varepsilon_t$ é o ruído. \n\nEm alguns casos essa relação é multiplicativa, ou seja,\n\n$$X_t=\\exp\\{\\hbox{sinal}(t)+\\varepsilon_t\\},$$ e, nesses casos, aplicamos o logaritmo na série para que as componentes se tornem aditivas.\n\nOs sinais mais importantes são:\n\n-   Tendência: um comportamento de subida ou descida que pode ser observado no médio/longo prazo. Uma série temporal com tendência costuma ser bem representada por polinômios, ou seja\n$$x_t= \\sum_{j=0}^q\\beta_j t^j +\\varepsilon_t.$$\n\n-   Sazonalidade: é um padrão de oscilação que ocorre em um período fixo e conhecido. Cheias de rios e quantidade de chuva são exemplos de padrões sazonais. Em termos gerais, o padrão sazonal pode ser representado por um harmônico, ou seja, \n\n$$x_t=A\\cos\\left(\\phi+\\frac{2\\pi}{p}t\\right)+\\varepsilon_t$$\nonde $p$ é o período sazonal, $A$ é amplitude da onda e $\\phi$ a fase.\n\n-  Ciclos: é um padrão oscilatório sem período fixo, como o ciclo de recessão de uma economia. Modelar ciclos é um pouco mais complexo, mas veremos posteriormente que é possível escrever séries deste tipo como \n$$x_t=A_t\\cos\\left(\\phi_t+2\\pi\\lambda t\\right)+\\varepsilon_t,$$\nonde a  amplitude e a fase variam no tempo e o período $1/\\lambda$ é desconhecido.\n\nOs padrões oscilatórios (sazonalidade e ciclos) descritos acima variam em torno de zero. Caso seja necessário, um parâmetro $\\mu$ constante pode ser adicionado para caracterizar uma oscilação em torno de uma média.\n\nÉ possível que uma  série possua todos os sinais acima, sendo escrita como\n\n$$x_t=\\sum_{j=0}^q \\beta_j t^j+A\\cos\\left(\\phi+2\\pi\\lambda t\\right)+A_t\\cos\\left(\\phi_t+2\\pi\\lambda t\\right)+\\varepsilon_t$$\n\nO ruído é a parte aleatória da composição e  possui média zero. Isso implica que, para uma série com sinal $f(t)$, teremos\n\n$$E(x_t)=E(f(t))+E(\\varepsilon_t)=f(t)$$\ne\n$$Var(x_t)=Var(f(t)+\\varepsilon_t)=Var(\\varepsilon_t)$$\nOs ruídos mais importantes são:\n\n-   Ruído branco: possuem variância constante e são não correlacionados, ou seja $Cov(\\varepsilon_t,\\varepsilon_s)=0$ para todo $t\\neq s$.\n\n-   Média móvel de ordem $q$: sejam $\\ldots,\\varepsilon_{-2},\\varepsilon_{-1},\\varepsilon_{0},\\varepsilon_{1},\\ldots$ ruídos brancos. O ruído de média móvel de ordem $q$ é dado por\n$$\\eta_t=\\varepsilon_{t}+\\sum_{j=1}^q \\theta_j\\varepsilon_{t-j}.$$\n\n\n\nA série a seguir representa uma série mensal de concentração de $\\hbox{CO}_2$ na atmosfera em Mauna Loa, expressa em partes por milhão. Note o comportamento da tendência e da sazonalidade.\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(co2)\n```\n\n::: {.cell-output-display}\n![](sinal_files/figure-pdf/unnamed-chunk-1-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\n\n\nExistem diversas ferramentas que estimam a tendência e a sazonalidade. Dentre estas, detaca-se o STL, por sua robustez. Abaixo, ilustramos a decomposição da série `co2`. O termo `remainder`, também conhecido como resíduo, é calculado como \n\n$$e_t=x_t-\\hat{f}(t),$$\nonde $\\hat{f}(t)$ é o sinal (tendência+sazonalidade) ajustado. Se não houver qualquer outro sinal a ser ajustado, então $e_t$ é uma estimativa para $\\varepsilon_t$.\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# p é o período do padrão sazonal\np = 12\nplot(stl(co2,p))\n```\n\n::: {.cell-output-display}\n![](sinal_files/figure-pdf/unnamed-chunk-2-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\n\n\n\n<div class='alert alert-warning'>\n**Exercício.** Considere a série `AirPassengers`, disponível no pacote `datasets`. \n\n1. Faça um gráfico da série temporal e procure determinar suas componentes.\n\n2. A função `decompose` estima a sazonalidade assumindo a média das observações correspodentes ao mesmo fator sazonal (por exemplo, todos os janeiros). Faça um gráfico do resultado do `decompose` para esta série e discuta os resultados (em especial o termo `random`, que é o resíduo da decomposição).\n\n3. Repita o item 2, mas utilizando a função `stl`. Quais são as principais diferenças?\n\n4. Aplique o logaritmo da série e verifique o seu gráfico. Quais são as semelhanças e diferenças deste gráfico com o obtido no item 1?\n\n</div>\n\n<div class>\n**Exercício.** \n Na série abaixo temos a taxa de desemprego mensal no Brasil entre março de 2002 e dezembro de 2015.\n Analise as componentes desta série.\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nurl <- 'https://www.dropbox.com/s/rmgymzsic99qawd/desemprego.csv?dl=1'\nbanco <- read.csv(url, sep = ';', h = F)\n```\n:::\n\n\n\n\n\n\n\n</div>\n\n## A função de aucorrelação\n\n\nConsidere inicialmente uma amostra aleatória $X_1,\\ldots,X_n$ (ou seja, todas as variáveis são independentes e possuem a mesma distribuição). Sejam $$A_h=\\{X_1,\\ldots,X_{n-h}\\}$$ e $$B_h=\\{X_h,\\ldots,X_n\\}.$$ Então, a correlação entre $A_h$ e $B_h$ é nula.\n\nDeste modo, um meio de verificar se a coleção observada é uma série temporal é observar a correlação amostral entre $$a_h=\\{x_1,\\ldots,x_{n-h}\\}$$ e $$b_h=\\{x_h,\\ldots,x_n\\},$$ para diferentes valores de $h$.\n\nA função $r(h)$ que representa a correlação amostral entre $a_h$ e $b_h$ é denominada **autocorrelação**. O valor $h$ é denominado **defasagem** (do inglês, *lag*).\n\n::: {.alert .alert-success}\n<strong>Propriedades</strong>\n\n-   $r(0)=1$\n\n-   $-1\\leq r(h) \\leq 1$\n:::\n\n::: {.alert .alert-success}\n<strong>Correlograma</strong> O gráfico $(h,r(h))$ é denominado correlograma, ou gráfico da função de autocorrelação.\n:::\n\n### O correlograma de uma amostra aleatória\n\nQuando a amostra é aleatória, a função de autocorrelação é nula para qualquer defasagem diferente de 0. Deste modo, o correlograma deve apresentar valores próximos de zero.\n\nPara entender o que próximo de zero significa, o limites do intervalo de confiança para o coeficiente de correlação sobre a hipótese de que esta é nula são colocados no gráfico.\n\nAbaixo ilustramos um correlograma para uma amostra de variáveis aleatórias independentes com distribuição normal padrão.\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- rnorm(120)\n\n# correlograma\nacf(x)\n```\n\n::: {.cell-output-display}\n![](sinal_files/figure-pdf/unnamed-chunk-4-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\n# o mesmo correlograma com uma defasagem maior\nacf(x, lag = 50)\n```\n\n::: {.cell-output-display}\n![](sinal_files/figure-pdf/unnamed-chunk-4-2.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\n\n\n### O correlograma com a componente de tendência\n\nQuando uma série exibe tendência, o correlograma exibe um descaimento lento e persistente.\n\nConsidere, por exemplo, a série\n\n$$x_t= t + \\varepsilon_t,$$ onde $\\varepsilon_t\\sim\\hbox{Normal}(0,5^2)$. Abaixo simulamos essa série e apresentamos o respectivo correlograma\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- rnorm(100, 1:100, 5)\n\noo <- par( mfrow=c(1,2))\nts.plot(x)\nacf(x, lag = 50)\n```\n\n::: {.cell-output-display}\n![](sinal_files/figure-pdf/unnamed-chunk-5-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\npar(oo)\n```\n:::\n\n\n\n\n\n\n\n\nObserve as similaridades do correlograma acima com o observado para a série de acidentes aéreos mensais vista anteriormente.\n\n\n\n\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\noo <- par( mfrow=c(1,2))\nts.plot( fab_mes , ylab = 'No. acidentes aéreos mensal' )\nacf(fab_mes , lag = 50,  main ='correlograma')\n```\n\n::: {.cell-output-display}\n![](sinal_files/figure-pdf/unnamed-chunk-7-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\npar(oo)\n```\n:::\n\n\n\n\n\n\n\n\n### O correlograma com a componente de sazonalidade - sinal harmônico\n\nO sinal sazonal é caracterizado por um comportamento periódico. Existem dois comportamentos sazonais típicos. O primeiro é baseado na função harmônica:\n\n$$\\hbox{sinal}(t)=A\\cos\\left(\\frac{2\\pi}{p}t + \\phi\\right)$$ Neste tipo de sinal, há um comportamento em forma de onda já estabelecido. Eis algumas informações importantes:\n\n-   O valor $p$, denominado período, equivale ao tempo que demora para o padrão se repetir.\n\n-   $A$ é denominado amplitude e representa o maior/menor valor que este sinal pode aingir.\n\n-   Por último, $\\phi$ é denominado fase, e serve basicamente para deslocar a onda.\n\nAbaixo seguem alguns exemplos de harmônicos, todos com período 12:\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\noo <- par( cex = 1.3)\ncurve( cos( x* 2*pi/12), 0,24, lwd = 2, ylab = expression( cos( 2*pi*t/12 )))\nabline(h = 0, lty = 2 )\nabline(v=12, lty = 2)\n```\n\n::: {.cell-output-display}\n![](sinal_files/figure-pdf/unnamed-chunk-8-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\ncurve( .5*cos( x* 2*pi/12), 0,24, lwd = 2, ylab = expression( .5*cos( 2*pi*t/12 )), ylim = c(-1,1))\nabline(h = 0, lty = 2 )\nabline(v=12, lty = 2)\n```\n\n::: {.cell-output-display}\n![](sinal_files/figure-pdf/unnamed-chunk-8-2.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\ncurve( cos( x* 2*pi/12+90), 0,24, lwd = 2, ylab = expression( cos( 2*pi*t/12 +90)), ylim = c(-1,1))\nabline(h = 0, lty = 2 )\nabline(v=12, lty = 2)\n```\n\n::: {.cell-output-display}\n![](sinal_files/figure-pdf/unnamed-chunk-8-3.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\n\n\nAbaixo simulamos uma série temporal com um sinal do tipo harmônico. Observe que o comportamento em forma de onda é aparente na função de autocorrelação.\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- cos( 2*pi/12 * 1:100) + rnorm(100,0,.1)\n\noo <- par( mfrow = c(1,2))\nts.plot(x)\nacf(x)\n```\n\n::: {.cell-output-display}\n![](sinal_files/figure-pdf/unnamed-chunk-9-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\npar(oo)\n```\n:::\n\n\n\n\n\n\n\n\nAbaixo, apresentamos a temperatura mensal observada no Castelo de Nottingham, entre 1920-1939. Compare os resultados com os gráficos acima.\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\noo <- par( mfrow = c(1,2))\n  plot(nottem)\n  acf(nottem)\n```\n\n::: {.cell-output-display}\n![](sinal_files/figure-pdf/unnamed-chunk-10-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\npar(oo)  \n```\n:::\n\n\n\n\n\n\n\n\n### O correlograma com a componente de sazonalidade - sinal autorregressivo\n\nNesse tipo de sazonalidade, ainda há um período $p$, mas não há um sinal harmônico. O valor da série no tempo $t$ é baseado no valor observado no tempo $t-p$.\n\nQuando a sazonalidade possue essa característica, há uma autocorrelação marcante nos múltiplos de $p$. Observe a série simulada abaixo, com um período $p=12$\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\noo <- par( mfrow = c(1,2))\nx <- rnorm(12,0,.1)\nfor(i in 13:100) x[i] <- .6*x[i-12] + rnorm(1,0,.05)\nts.plot(x)\nacf(x, lag = 50)\n```\n\n::: {.cell-output-display}\n![](sinal_files/figure-pdf/unnamed-chunk-11-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\npar(oo)\n```\n:::\n\n\n\n\n\n\n\n\n## Exercícios\n\n::: {.alert .alert-warning}\n<strong>Exercício 1</strong> Estude o comportamento da série `ldeaths`, que conta o número mensal de óbitos por doenças pulmonares no Reino Unido.\n:::\n\n::: {.atert .alert-warning}\n<strong>Exercício 2</strong> Estude o comportamento da série do número de óbitos maternos mensais.\n:::\n\n::: {.alert .alert-warning}\n<strong>Exercício 3</strong> Em 2017, um epidemiologista estava interessado na série de suicídios no Mato Grosso do Sul. O banco de dados utilizado é dado a seguir. Construa uma série mensal e estude seu comportamento\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nurl <- 'https://drive.google.com/uc?authuser=0&id=1DMSgrQDl0636Lw0Y0MYJHJrgw_2uXntM&export=download'\n```\n:::\n\n\n\n\n\n\n\n:::\n",
    "supporting": [
      "sinal_files\\figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}