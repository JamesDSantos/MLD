[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Introdução aos modelos lineares dinâmicos",
    "section": "",
    "text": "Prefácio",
    "crumbs": [
      "Prefácio"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Manipulação de séries temporais univariadas no software R",
    "section": "",
    "text": "1.1 Definição de séries temporais\nConsidere um fenômeno aleatório que é observado ao longo do tempo. A coleção de variáveis aleatórias indexadas no tempo, associadas a este fenômeno, é denominada série temporal. Neste caso, para cada instante de tempo \\(t\\), há uma variável \\(X(t)\\) associada.\nAlguns autores definem séries temporais simplesmente como valores observados ao longo do tempo.No entanto, essa definição não é útil para nós, uma vez que o tempo não necessariamente possui influência na variável, ou seja, é possível que a distribuição de \\(X(t)\\) não dependa de \\(t\\).\nA partir deste momento, \\(X(t)\\) será escrita como \\(X_t\\) e representará a variável aleatória associada ao tempo \\(t\\) e a versão minúscula \\(x_t\\) representará o valor observado.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Manipulação de séries temporais univariadas no software `R`</span>"
    ]
  },
  {
    "objectID": "intro.html#definição-de-séries-temporais",
    "href": "intro.html#definição-de-séries-temporais",
    "title": "1  Manipulação de séries temporais univariadas no software R",
    "section": "",
    "text": "Figure 1 - Ilustração de uma série temporal\n\n\n\n\nImportante: estamos interessados apenas em séries temporais nas quais o modelo de probabilidades depende do tempo \\(t\\).",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Manipulação de séries temporais univariadas no software `R`</span>"
    ]
  },
  {
    "objectID": "intro.html#a-classe-ts-e-a-função-window",
    "href": "intro.html#a-classe-ts-e-a-função-window",
    "title": "1  Manipulação de séries temporais univariadas no software R",
    "section": "1.2 A classe ts e a função window",
    "text": "1.2 A classe ts e a função window\nNessa seção vamos distutir a classe ts do R. Ela é particularmente útil para fazer gráficos de séries temporais. A função ts possui vários argumentos importantes:\n\ndata: vetor ou matriz da série observada\nfrequency: esse valor representa o número de observações por período. Vamos discutir essa particularidade em outro momento, mas para a maioria das séries, o período é representado por um ano e o valor de frequency está relacionado com quantas observações são necessárias para completar um ano. Por exemplo, se os dados são registrados mensalmente, temos frequency=12. Em caso de trimestres, frequency=4. O valor padrão é frequency=1.\ndeltat: é o inverso do número de observações por período. Apenas um entre frequency e deltat deve ser dado.\nstart: representa o tempo no qual a série começa. Pode ser representado por um único número ou por um vetor de dois números, com o segundo representando o momento dentro do período. Por exemplo:\n\nse frequancy=12 (meses em um ano) então start=c(1996,2) implica que a primeira observação data de fevereiro de 1996.\nse frequancy=4 (trimestres em um ano) então start=c(1996,2) implica que a primeira observação data do segundo trimestre dede 1996.\n\nend: representa o tempo no qual a série termina. A sintaxe é a mesma do start\nnames: é um vetor com o nomes das séries. É utilizado apenas quando há mais de uma série temporal.\n\n\nExemplo\nVamos ilustrar a construção de um objeto ts`` utilizando a tabela abaixo, que apresenta o número de nascidos vivos por mês na cidade de Manaus em 2021.\n\n\n\nMês\nNo. nascidos vivos\n\n\n\n\nJaneiro\n3043\n\n\nFevereiro\n2902\n\n\nMarço\n3166\n\n\nAbril\n3014\n\n\nMaio\n3095\n\n\nJunho\n2955\n\n\nJulho\n3087\n\n\nAgosto\n3141\n\n\nSetembro\n3129\n\n\nOutubro\n3096\n\n\nNovembro\n3191\n\n\nDezembro\n3222\n\n\n\nVamos guarda a série no vetor x e construir o objeto y na classe ts.\n\nx &lt;- c(\n  3043, 2902, 3166, 3014,\n3095, 2955, 3087, 3141,\n3129, 3096, 3191, 3222\n\n)\ny &lt;- ts( x, start = c(2021,1), frequency = 12)\ny\n\n      Jan  Feb  Mar  Apr  May  Jun  Jul  Aug  Sep  Oct  Nov  Dec\n2021 3043 2902 3166 3014 3095 2955 3087 3141 3129 3096 3191 3222\n\n\nA função plot reconhece um objeto na classe ts e constrói um gráfico com o tempo devidamente marcado no eixo as abscissas.\n\nplot(y)\n\n\n\n\n\n\n\n\nOutros detalhes gráficos da função plot podem ser utilizados.\n\nplot(y, ylab = 'No. nascidos vivos', lwd = 2, col = 'seagreen', xlab = 'Ano', main = 'Série mensal de nascidos vivos em Manaus', sub='Fonte: Sistema de Informação sobre Nascidos Vivos/SUS')\n\n\n\n\n\n\n\n\n\nÉ possível extrair os argumentos de um ts já criado utilizando funções com os mesmos nomes dos respectivos argumentos. No exemplo acima, criamos o objeto denominado y. Abaixo, extraímos os argumentos deste objeto.\n\nstart(y)\n\n[1] 2021    1\n\nend(y)\n\n[1] 2021   12\n\nfrequency(y)\n\n[1] 12\n\ndeltat(y)\n\n[1] 0.08333333\n\n\nA função window é particularmente útil para selecionar um subconjunto da série temporal. Seus argumentos são os mesmos da função ts.\n\nExemplo Utilizando o mesmo conjunto de dados do exemplo anterior, vamos usar a função window para extrair apenas os nascimentos entre junho e agosto.\n\nz &lt;- window(y, start=c(2021,6), end = c(2021,8))\nz\n\n      Jun  Jul  Aug\n2021 2955 3087 3141\n\n\nAcima, z é um novo objeto ts. Podemos usar a função lines destacar a parte selecionada da série em um gráfico já existente. Abaixo, descatamos os dados selecionados em z.\n\nplot(y, ylab = 'No. nascidos vivos', lwd = 2, col = 'seagreen', xlab = 'Ano', main = 'Série \nmensal de nascidos vivos em Manaus', sub='Fonte: Sistema de Informação sobre Nascidos Vivos/SUS')\nlines(z, col ='brown', lwd = 4 )\n\n\n\n\n\n\n\n\n\n\nExercício 1\nA série abaixo representa o número de homicídios mensais no Amazonas, segundo causa básica de óbito, entre os anos 2000 e 2023.\n\nrequire(gsheet)\nurl = 'https://docs.google.com/spreadsheets/d/1rtiyOZ1W3SRIWZJTR1RyBmxmnGO11x005GNGrgLBr5A/edit?usp=sharing'\n\nhom = gsheet2tbl(url)\n\n\nConstrua um objeto do tipo ts\nFaça um gráfico da série.\nCrie um janela para marcar o período entre o início da pandemia de COVID-19 (março de 2020) e o primeiro dia sem mortes por COVID-19 (julho de 2021)\nRepresente a janela acima no gráfico anterior. O que esse gráfico revela?",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Manipulação de séries temporais univariadas no software `R`</span>"
    ]
  },
  {
    "objectID": "intro.html#a-classe-date-e-o-pacote-lubridate",
    "href": "intro.html#a-classe-date-e-o-pacote-lubridate",
    "title": "1  Manipulação de séries temporais univariadas no software R",
    "section": "1.3 A classe Date e o pacote lubridate",
    "text": "1.3 A classe Date e o pacote lubridate\nNessa seção discutimos a classe Date, responsável por operações com datas no R. São apresentadas as principais funções do pacote base. Em seguida, apresentamos o pacote lubridate, que oferece funções adicionais e uma sintaxe mais fluida.\nNo pacote base, as datas são objeto da classe Date. Abaixo, transformamos o texto que representa 3 de agosto de 1998 nessa classe.\n\n# 3 de agosto de 1998 (formato americano)\nx &lt;- '1998/8/3'\ny &lt;- as.Date(x)\n\nExistem diversas funções que interagem com objetos nessa classe:\n\nweekdays: Retorna o dia da semana.\nmonths: Retorna o nome do mês.\nquarters: Retorna o trimestre do ano (Q1,Q2,Q3 ou Q4).\n\nAbaixo, ilustramos o uso dessas funções com a data 3 de agosto de 1998.\n\nweekdays(y)\n\n[1] \"segunda-feira\"\n\nmonths(y)\n\n[1] \"agosto\"\n\nquarters(y)\n\n[1] \"Q3\"\n\n\nOutra vantagem desta classe é a possibilidade de calcular a diferença em dias entre duas datas, utilizando a função -. Abaixo mostramos a diferença entre 3 de agosto de 1998 e 3 de agosto de 1999.\n\nz &lt;- as.Date('1999-08-03')\nz-y\n\nTime difference of 365 days\n\n\nEm certas aplicações, é necessário criar um vetor contendo datas em sequência. A função seq interage com objetos da classe Date, permitindo que o argumento by receba as strings day, week,month, quarter e year. Abaixo, criamos um vetor mensal que começa em 3 de agosto de 1998 e terminando e 3 de agosto de 1999.\n\ninicio &lt;- as.Date('1998-08-03')\nfim &lt;- as.Date('1999-08-03')\nseq(inicio, fim, by='month')\n\n [1] \"1998-08-03\" \"1998-09-03\" \"1998-10-03\" \"1998-11-03\" \"1998-12-03\"\n [6] \"1999-01-03\" \"1999-02-03\" \"1999-03-03\" \"1999-04-03\" \"1999-05-03\"\n[11] \"1999-06-03\" \"1999-07-03\" \"1999-08-03\"\n\n\nObserve que a conversão da string para Date é realizada considerando o formato americano por padrão. É possível usar a função as.Date para ler qualquer formato, modificando o argumento format. No entanto, o pacote lubridate oferece funções mais simples para essa conversão:\n\nymd: Converte strings no formato “ano, mês, dia”, como “2023-10-26”.\nmdy: Converte strings no formato “mês, dia, ano”, como “10-26-2023”.\ndmy: Converte strings no formato “dia, mês, ano”, como “26-10-2023”.\n\nAbaixo, transformamos a data 3/8/1998 para o formato americano.\n\nrequire(lubridate)\n# 3 de agosto de 1998 (formato nacional)\nx &lt;- '3/8/1998'\ndmy(x)\n\n[1] \"1998-08-03\"\n\n\nO lubridate também ofere a possibilidade de trabalhar com informações de tempo dentro de um dia, como horas, minutos e segundos. Por exemplo, a informação 15h30 de 3 de agosto de 1998 é lida como\n\nx &lt;- '3/8/1998 15:30:00'\ndmy_hms(x)\n\n[1] \"1998-08-03 15:30:00 UTC\"\n\n\nO lubridate possui as funções month e wday, que funcionam de modo análgo às funções months e weekdays. Além disso, o lubridate traz uma série de funções adicionais como:\n\nyear: retorna o ano de uma data\nday: retornam o dia de uma data (útil para o formado xxx-xx-xx 00:00:00)\nhour, minute, second: Retornam a hora, minuto e segundo de um objeto de data e tempo.\n\nAs funções de arredondamento de data também são úteis, especialmente para obter contagens mensais, anuais, etc. Elas são floor_date e ceiling_date e são responsáveis por arredondar uma data para o início ou o fim de um período, respectivamente. Abaixo, arredondamos a data 3 de agosto de 1998 para o começo do mês.\n\nx &lt;- dmy('03/08/1998')\nfloor_date(x, 'month')\n\n[1] \"1998-08-01\"\n\n\n\nExemplo\nA Força Aérea Brasileira (FAB), por meio do Centro de Investigação e Prevenção de Acidentes Aeronáuticos (CENIPA), possui um dashboard para explorar dados sobre incidentes e acidentes aéreos no Brasil. Um acidente é definido como uma ocorrência grave associada à operação de uma aeronave que resulta em lesões ou morte, dano estrutural da aeronave ou aeronave desaparecida. Os demais casos são classificados como incidentes. Os dados, atualizados em 11/08/2025, estão disponíveis para esse curso na url abaixo:\n\nurl &lt;- 'https://docs.google.com/spreadsheets/d/1BjTXFMmTpcxKdRHCr5IIDJde9yr0s3oAAfyj2vdVuX8/edit?usp=sharing'\n\naereo &lt;-  gsheet2tbl(url)\nhead(aereo)\n\n# A tibble: 6 × 10\n  Link   Data  Matrícula Classificação Tipo  Localidade UF    Aeródromo Operação\n  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;   \n1 https… 05/0… ****      INCIDENTE     FALH… RIO DE JA… RJ    FAER      TÁXI AÉ…\n2 https… 04/0… ****      INCIDENTE     FALH… MARICÁ     RJ    NCAD      TÁXI AÉ…\n3 https… 01/0… ****      INCIDENTE     FALH… RIO DE JA… RJ    SBJR      TÁXI AÉ…\n4 https… 31/0… ****      INCIDENTE     FALH… PALMAS     TO    SBPJ      REGULAR \n5 https… 29/0… ****      INCIDENTE     FALH… BOA VISTA  RR    FAER      TÁXI AÉ…\n6 https… 29/0… ****      INCIDENTE     COLI… RECIFE     PE    SBRF      REGULAR \n# ℹ 1 more variable: Status &lt;chr&gt;\n\n\nA unidade amostral é o acidente/indicente. Estamos interessados em criar uma série temporal com o número de acidentes mensais. Abaixo, filtramos apenas os acidentes (coluna Classificção) e, em seguida, transformamos as datas em objetos do tipo Date.\n\nacidentes &lt;- aereo[ aereo$Classificação=='ACIDENTE', ]\ndatas &lt;- dmy(acidentes$Data)\n\nAgora, vamos arredondar todas as datas para o primeiro dia do mês. Em seguida, contaremos as frequências para cada mês/ano\n\nmes_ano &lt;- floor_date(datas, 'month')\ncontagem &lt;- table(mes_ano)\ncontagem\n\nmes_ano\n2015-01-01 2015-02-01 2015-03-01 2015-04-01 2015-05-01 2015-06-01 2015-07-01 \n        12         14         15         19         16         14         16 \n2015-08-01 2015-09-01 2015-10-01 2015-11-01 2015-12-01 2016-01-01 2016-02-01 \n        13         17          9         14         13         20         16 \n2016-03-01 2016-04-01 2016-05-01 2016-06-01 2016-07-01 2016-08-01 2016-09-01 \n        20         19          8          5         11          4         17 \n2016-10-01 2016-11-01 2016-12-01 2017-01-01 2017-02-01 2017-03-01 2017-04-01 \n        20          9         15         17         16         11         16 \n2017-05-01 2017-06-01 2017-07-01 2017-08-01 2017-09-01 2017-10-01 2017-11-01 \n         8          6         12          6         14         15         16 \n2017-12-01 2018-01-01 2018-02-01 2018-03-01 2018-04-01 2018-05-01 2018-06-01 \n         9         18         19         18         18         15         13 \n2018-07-01 2018-08-01 2018-09-01 2018-10-01 2018-11-01 2018-12-01 2019-01-01 \n        15          8         11          8         14         10         20 \n2019-02-01 2019-03-01 2019-04-01 2019-05-01 2019-06-01 2019-07-01 2019-08-01 \n        10         17         14         12         13         15          8 \n2019-09-01 2019-10-01 2019-11-01 2019-12-01 2020-01-01 2020-02-01 2020-03-01 \n        14          6         11         11         11         17         12 \n2020-04-01 2020-05-01 2020-06-01 2020-07-01 2020-08-01 2020-09-01 2020-10-01 \n        14          9          6         16          9         15         18 \n2020-11-01 2020-12-01 2021-01-01 2021-02-01 2021-03-01 2021-04-01 2021-05-01 \n         7         16         13         16         17          7         17 \n2021-06-01 2021-07-01 2021-08-01 2021-09-01 2021-10-01 2021-11-01 2021-12-01 \n         5          8          8         12          7         13         18 \n2022-01-01 2022-02-01 2022-03-01 2022-04-01 2022-05-01 2022-06-01 2022-07-01 \n        15         12         13         13          9         13          8 \n2022-08-01 2022-09-01 2022-10-01 2022-11-01 2022-12-01 2023-01-01 2023-02-01 \n         8         12         10         13         12         21         21 \n2023-03-01 2023-04-01 2023-05-01 2023-06-01 2023-07-01 2023-08-01 2023-09-01 \n        18         12         17         15          7          6          5 \n2023-10-01 2023-11-01 2023-12-01 2024-01-01 2024-02-01 2024-03-01 2024-04-01 \n         8         14         11         17         21         12         22 \n2024-05-01 2024-06-01 2024-07-01 2024-08-01 2024-09-01 2024-10-01 2024-11-01 \n         7         15         13          9         13         12         14 \n2024-12-01 2025-01-01 2025-02-01 2025-03-01 2025-04-01 2025-05-01 2025-06-01 \n        20         22         11         13         20         10          5 \n2025-07-01 \n        11 \n\n\nÉ sempre importante checar o resultado em contagem, para verificar se não há algum mês ausente. Como não o caso aqui, vamos construir um objeto do tipo ts e fazer o gráfico da série temporal.\n\nserie &lt;- ts(contagem, start=c(2015,1), frequency = 12 )\nplot(serie, ylab = 'No. de acidentes aéreos', xlab = 'Ano', sub= 'Fonte: CENIPA' )\n\n\n\n\n\n\n\n\n\n\nExercício 2\nA série abaixo contém as datas dos óbitos maternos no Brasil a partir de 2010.\n\nurl &lt;- 'https://drive.google.com/uc?authuser=0&id=1tYFFT9L2iopKmBDUI3P8qNIRaOnMYj7d&export=download'\n\nCrie uma série temporal com o número de óbitos mensal e faça um gráfico. Crie uma janela para destacar no gráfico o período da pandemia de COVID-19 (março de 2020 até julhode 2021).",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Manipulação de séries temporais univariadas no software `R`</span>"
    ]
  },
  {
    "objectID": "sinal.html",
    "href": "sinal.html",
    "title": "2  Sinal, ruído e correlograma",
    "section": "",
    "text": "2.1 Sinal e ruído\nEm geral, a série temporal possui componentes de dois tipos: sinal e ruído. O primeiro é uma função do tempo geralmente relacionado com a média da série em dado instante de tempo, enquanto que o segundo está relacionado com a variância. Podemos assumir que essa relação é aditiva:\n\\[X_t=\\hbox{sinal}(t)+\\varepsilon_t\\] onde \\(\\varepsilon_t\\) é o ruído.\nEm alguns casos essa relação é multiplicativa, ou seja,\n\\[X_t=\\exp\\{\\hbox{sinal}(t)+\\varepsilon_t\\},\\] e, nesses casos, aplicamos o logaritmo na série para que as componentes se tornem aditivas.\nOs sinais mais importantes são:\n\\[x_t=A\\cos\\left(\\phi+\\frac{2\\pi}{p}t\\right)+\\varepsilon_t\\] onde \\(p\\) é o período sazonal, \\(A\\) é amplitude da onda e \\(\\phi\\) a fase.\nOs padrões oscilatórios (sazonalidade e ciclos) descritos acima variam em torno de zero. Caso seja necessário, um parâmetro \\(\\mu\\) constante pode ser adicionado para caracterizar uma oscilação em torno de uma média.\nÉ possível que uma série possua todos os sinais acima, sendo escrita como\n\\[x_t=\\sum_{j=0}^q \\beta_j t^j+A\\cos\\left(\\phi+2\\pi\\lambda t\\right)+A_t\\cos\\left(\\phi_t+2\\pi\\lambda t\\right)+\\varepsilon_t\\]\nO ruído é a parte aleatória da composição e possui média zero. Isso implica que, para uma série com sinal \\(f(t)\\), teremos\n\\[E(x_t)=E(f(t))+E(\\varepsilon_t)=f(t)\\] e \\[Var(x_t)=Var(f(t)+\\varepsilon_t)=Var(\\varepsilon_t)\\] Os ruídos mais importantes são:\nA série a seguir representa uma série mensal de concentração de \\(\\hbox{CO}_2\\) na atmosfera em Mauna Loa, expressa em partes por milhão. Note o comportamento da tendência e da sazonalidade.\nplot(co2)\nExistem diversas ferramentas que estimam a tendência e a sazonalidade. Dentre estas, detaca-se o STL, por sua robustez. Abaixo, ilustramos a decomposição da série co2. O termo remainder, também conhecido como resíduo, é calculado como\n\\[e_t=x_t-\\hat{f}(t),\\] onde \\(\\hat{f}(t)\\) é o sinal (tendência+sazonalidade) ajustado. Se não houver qualquer outro sinal a ser ajustado, então \\(e_t\\) é uma estimativa para \\(\\varepsilon_t\\).\n# p é o período do padrão sazonal\np = 12\nplot(stl(co2,p))",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Sinal, ruído e correlograma</span>"
    ]
  },
  {
    "objectID": "sinal.html#sinal-e-ruído",
    "href": "sinal.html#sinal-e-ruído",
    "title": "2  Sinal, ruído e correlograma",
    "section": "",
    "text": "Tendência: um comportamento de subida ou descida que pode ser observado no médio/longo prazo. Uma série temporal com tendência costuma ser bem representada por polinômios, ou seja \\[x_t= \\sum_{j=0}^q\\beta_j t^j +\\varepsilon_t.\\]\nSazonalidade: é um padrão de oscilação que ocorre em um período fixo e conhecido. Cheias de rios e quantidade de chuva são exemplos de padrões sazonais. Em termos gerais, o padrão sazonal pode ser representado por um harmônico, ou seja,\n\n\n\nCiclos: é um padrão oscilatório sem período fixo, como o ciclo de recessão de uma economia. Modelar ciclos é um pouco mais complexo, mas veremos posteriormente que é possível escrever séries deste tipo como \\[x_t=A_t\\cos\\left(\\phi_t+2\\pi\\lambda t\\right)+\\varepsilon_t,\\] onde a amplitude e a fase variam no tempo e o período \\(1/\\lambda\\) é desconhecido.\n\n\n\n\n\n\n\nRuído branco: possuem variância constante e são não correlacionados, ou seja \\(Cov(\\varepsilon_t,\\varepsilon_s)=0\\) para todo \\(t\\neq s\\).\nMédia móvel de ordem \\(q\\): sejam \\(\\ldots,\\varepsilon_{-2},\\varepsilon_{-1},\\varepsilon_{0},\\varepsilon_{1},\\ldots\\) ruídos brancos. O ruído de média móvel de ordem \\(q\\) é dado por \\[\\eta_t=\\varepsilon_{t}+\\sum_{j=1}^q \\theta_j\\varepsilon_{t-j}.\\]\n\n\n\n\n\n\n\nExercício. Considere a série AirPassengers, disponível no pacote datasets.\n\nFaça um gráfico da série temporal e procure determinar suas componentes.\nA função decompose estima a sazonalidade assumindo a média das observações correspodentes ao mesmo fator sazonal (por exemplo, todos os janeiros). Faça um gráfico do resultado do decompose para esta série e discuta os resultados (em especial o termo random, que é o resíduo da decomposição).\nRepita o item 2, mas utilizando a função stl. Quais são as principais diferenças?\nAplique o logaritmo da série e verifique o seu gráfico. Quais são as semelhanças e diferenças deste gráfico com o obtido no item 1?\n\n\n\nExercício. Na série abaixo temos a taxa de desemprego mensal no Brasil entre março de 2002 e dezembro de 2015. Analise as componentes desta série.\n\nurl &lt;- 'https://www.dropbox.com/s/rmgymzsic99qawd/desemprego.csv?dl=1'\nbanco &lt;- read.csv(url, sep = ';', h = F)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Sinal, ruído e correlograma</span>"
    ]
  },
  {
    "objectID": "sinal.html#a-função-de-aucorrelação",
    "href": "sinal.html#a-função-de-aucorrelação",
    "title": "2  Sinal, ruído e correlograma",
    "section": "2.2 A função de aucorrelação",
    "text": "2.2 A função de aucorrelação\nConsidere inicialmente uma amostra aleatória \\(X_1,\\ldots,X_n\\) (ou seja, todas as variáveis são independentes e possuem a mesma distribuição). Sejam \\[A_h=\\{X_1,\\ldots,X_{n-h}\\}\\] e \\[B_h=\\{X_h,\\ldots,X_n\\}.\\] Então, a correlação entre \\(A_h\\) e \\(B_h\\) é nula.\nDeste modo, um meio de verificar se a coleção observada é uma série temporal é observar a correlação amostral entre \\[a_h=\\{x_1,\\ldots,x_{n-h}\\}\\] e \\[b_h=\\{x_h,\\ldots,x_n\\},\\] para diferentes valores de \\(h\\).\nA função \\(r(h)\\) que representa a correlação amostral entre \\(a_h\\) e \\(b_h\\) é denominada autocorrelação. O valor \\(h\\) é denominado defasagem (do inglês, lag).\n\nPropriedades\n\n\\(r(0)=1\\)\n\\(-1\\leq r(h) \\leq 1\\)\n\n\n\nCorrelograma O gráfico \\((h,r(h))\\) é denominado correlograma, ou gráfico da função de autocorrelação.\n\n\n2.2.1 O correlograma de uma amostra aleatória\nQuando a amostra é aleatória, a função de autocorrelação é nula para qualquer defasagem diferente de 0. Deste modo, o correlograma deve apresentar valores próximos de zero.\nPara entender o que próximo de zero significa, o limites do intervalo de confiança para o coeficiente de correlação sobre a hipótese de que esta é nula são colocados no gráfico.\nAbaixo ilustramos um correlograma para uma amostra de variáveis aleatórias independentes com distribuição normal padrão.\n\nx &lt;- rnorm(120)\n\n# correlograma\nacf(x)\n\n\n\n\n\n\n\n# o mesmo correlograma com uma defasagem maior\nacf(x, lag = 50)\n\n\n\n\n\n\n\n\n\n\n2.2.2 O correlograma com a componente de tendência\nQuando uma série exibe tendência, o correlograma exibe um descaimento lento e persistente.\nConsidere, por exemplo, a série\n\\[x_t= t + \\varepsilon_t,\\] onde \\(\\varepsilon_t\\sim\\hbox{Normal}(0,5^2)\\). Abaixo simulamos essa série e apresentamos o respectivo correlograma\n\nx &lt;- rnorm(100, 1:100, 5)\n\noo &lt;- par( mfrow=c(1,2))\nts.plot(x)\nacf(x, lag = 50)\n\n\n\n\n\n\n\npar(oo)\n\nObserve as similaridades do correlograma acima com o observado para a série de acidentes aéreos mensais vista anteriormente.\n\noo &lt;- par( mfrow=c(1,2))\nts.plot( fab_mes , ylab = 'No. acidentes aéreos mensal' )\nacf(fab_mes , lag = 50,  main ='correlograma')\n\n\n\n\n\n\n\npar(oo)\n\n\n\n2.2.3 O correlograma com a componente de sazonalidade - sinal harmônico\nO sinal sazonal é caracterizado por um comportamento periódico. Existem dois comportamentos sazonais típicos. O primeiro é baseado na função harmônica:\n\\[\\hbox{sinal}(t)=A\\cos\\left(\\frac{2\\pi}{p}t + \\phi\\right)\\] Neste tipo de sinal, há um comportamento em forma de onda já estabelecido. Eis algumas informações importantes:\n\nO valor \\(p\\), denominado período, equivale ao tempo que demora para o padrão se repetir.\n\\(A\\) é denominado amplitude e representa o maior/menor valor que este sinal pode aingir.\nPor último, \\(\\phi\\) é denominado fase, e serve basicamente para deslocar a onda.\n\nAbaixo seguem alguns exemplos de harmônicos, todos com período 12:\n\noo &lt;- par( cex = 1.3)\ncurve( cos( x* 2*pi/12), 0,24, lwd = 2, ylab = expression( cos( 2*pi*t/12 )))\nabline(h = 0, lty = 2 )\nabline(v=12, lty = 2)\n\n\n\n\n\n\n\ncurve( .5*cos( x* 2*pi/12), 0,24, lwd = 2, ylab = expression( .5*cos( 2*pi*t/12 )), ylim = c(-1,1))\nabline(h = 0, lty = 2 )\nabline(v=12, lty = 2)\n\n\n\n\n\n\n\ncurve( cos( x* 2*pi/12+90), 0,24, lwd = 2, ylab = expression( cos( 2*pi*t/12 +90)), ylim = c(-1,1))\nabline(h = 0, lty = 2 )\nabline(v=12, lty = 2)\n\n\n\n\n\n\n\n\nAbaixo simulamos uma série temporal com um sinal do tipo harmônico. Observe que o comportamento em forma de onda é aparente na função de autocorrelação.\n\nx &lt;- cos( 2*pi/12 * 1:100) + rnorm(100,0,.1)\n\noo &lt;- par( mfrow = c(1,2))\nts.plot(x)\nacf(x)\n\n\n\n\n\n\n\npar(oo)\n\nAbaixo, apresentamos a temperatura mensal observada no Castelo de Nottingham, entre 1920-1939. Compare os resultados com os gráficos acima.\n\noo &lt;- par( mfrow = c(1,2))\n  plot(nottem)\n  acf(nottem)\n\n\n\n\n\n\n\npar(oo)  \n\n\n\n2.2.4 O correlograma com a componente de sazonalidade - sinal autorregressivo\nNesse tipo de sazonalidade, ainda há um período \\(p\\), mas não há um sinal harmônico. O valor da série no tempo \\(t\\) é baseado no valor observado no tempo \\(t-p\\).\nQuando a sazonalidade possue essa característica, há uma autocorrelação marcante nos múltiplos de \\(p\\). Observe a série simulada abaixo, com um período \\(p=12\\)\n\nset.seed(123)\noo &lt;- par( mfrow = c(1,2))\nx &lt;- rnorm(12,0,.1)\nfor(i in 13:100) x[i] &lt;- .6*x[i-12] + rnorm(1,0,.05)\nts.plot(x)\nacf(x, lag = 50)\n\n\n\n\n\n\n\npar(oo)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Sinal, ruído e correlograma</span>"
    ]
  },
  {
    "objectID": "sinal.html#exercícios",
    "href": "sinal.html#exercícios",
    "title": "2  Sinal, ruído e correlograma",
    "section": "2.3 Exercícios",
    "text": "2.3 Exercícios\n\nExercício 1 Estude o comportamento da série ldeaths, que conta o número mensal de óbitos por doenças pulmonares no Reino Unido.\n\n\nExercício 2 Estude o comportamento da série do número de óbitos maternos mensais.\n\n\nExercício 3 Em 2017, um epidemiologista estava interessado na série de suicídios no Mato Grosso do Sul. O banco de dados utilizado é dado a seguir. Construa uma série mensal e estude seu comportamento\n\nurl &lt;- 'https://drive.google.com/uc?authuser=0&id=1DMSgrQDl0636Lw0Y0MYJHJrgw_2uXntM&export=download'",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Sinal, ruído e correlograma</span>"
    ]
  },
  {
    "objectID": "mld.html",
    "href": "mld.html",
    "title": "3  O modelo linear dinâmico",
    "section": "",
    "text": "3.1 O modelo linear dinâmico\nSeja \\(y_1,\\ldots,t\\) uma série temporal. Seja \\(D_j={y_1,\\ldots,y_j}\\). Dizemos que \\(y_t\\) é um modelo linear dinâmico se\n\\[\\begin{align}\ny_t|\\boldsymbol{\\theta}_t,D_{t-1}&\\sim\\hbox{Normal}(\\boldsymbol{F}_t'\\boldsymbol{\\theta}_t,V_t)\\\\\n\\boldsymbol{\\theta}_t|\\boldsymbol{\\theta}_{t-1},D_{t-1}&\\sim\\hbox{Normal}(\\boldsymbol{G}_t\\boldsymbol{\\theta}_{t-1},\\boldsymbol{W}_t)\n\\end{align}\\]\nA expressão acima, os \\(\\theta\\)’s são denominados estados. Para a completa especificação do modelo, devemos informar valores iniciais \\(m_0\\) e \\(C_0\\) que representam nossa opinião sobre os estados antes do tempo \\(1\\):\n\\[\\theta_0\\sim\\ N(m_0,C_0)\\] Escolhas diferentes para \\(\\boldsymbol{F}_t\\) e \\(\\boldsymbol{G}_t\\) permitem acomodar sinais diferentes.\nPode-se mostrar que \\(y_{t+h}|D_t\\) tem distribuição normal. Como \\(t+h\\) é um tempo não observado, essa é a distribuição para previsões. Neste caso, a função de previsão para o horizonte \\(h\\) é\n\\[f_t(h)=E(Y_{t+h}|D_{t})\\] onde \\(E(.)\\) sempre deve ser lido como média.\nO pacote para lidar com modelos lineares dinâmicos é o dlm. A função abaixo é utilizada para estimar as variâncias desconhecidas do modelo e deve sempre ser colocada no environment do R:\nrequire(dlm)\n\nCarregando pacotes exigidos: dlm\n\nmodFim &lt;- function(y,mod){\n  ffbs &lt;- dlmGibbsDIG(y, mod = mod, n.sample = 5000,\n                    a.y=1,b.y=100,a.theta=1,b.theta=100,\n                    save.states = FALSE, thin = 0)\n\nv_sim  &lt;- sample(ffbs$dV[-(1:2500)],2500,T)\n\nq &lt;- dim(ffbs$dW)[2]\nw_sim &lt;- NULL\nfor(j in 1:q){\n w_sim &lt;- c(w_sim, mean(sample(ffbs$dW[,j][-(1:2500)],2500,T)))\n}\n# declarando as variâncias na quádrupla\nmod$V &lt;- mean(v_sim)\nmod$W &lt;- diag( w_sim)\nreturn(mod)\n}\nTambém pode-se mostrar que \\(\\theta_{t-h}|D_t\\) tem distribuição normal. Como se trata da distribuição dos estados após verificar toda a série temporal, esta é a distribuição para a suavização.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>O modelo linear dinâmico</span>"
    ]
  }
]